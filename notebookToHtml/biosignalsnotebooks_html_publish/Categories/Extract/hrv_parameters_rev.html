<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>
   hrv_parameters
  </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js">
</script>
<!-- Custom stylesheet, it must be in the same directory as the html file -->
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML">
</script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
  </script>
<!-- End of mathjax configuration -->
<link href="../../styles/bsnb_style.css" rel="stylesheet"/></head>
<body>
<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>

<!--link rel="stylesheet" href="../../styles/header_style.css"-->
</p>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<table width="100%">
<tr>
<td class="header_image_color_6" id="image_td" width="15%">
<div class="header_image_6" id="image_img">
</div>
</td>
<td class="header_text">
          ECG Analysis - Heart Rate Variability Parameters
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="flex-container">
<div class="flex-item" id="diff_level">
<strong>
          Difficulty Level:
         </strong>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
</div>
<div class="flex-item-tag" id="tag">
<span id="tag_list">
<table id="tag_list_table">
<tr>
<td class="shield_left">
             Tags
            </td>
<td class="shield_right" id="tags">
             extract☁ecg☁hrv
            </td>
</tr>
</table>
</span>
<!-- [OR] Visit https://img.shields.io in order to create a tag badge-->
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Using an analogy with the programming paradigms, electrophysiological signals can be viewed as objects containing lots of information inside.
However obtatining knowledge from an object is only possible by accessing its attributes (characteristics).
       </p>
<p>
        In signal processing there is an identical logic, so, for extracting knowledge from signals (our objects), we need to identify their intrinsic characteristics (parameters).
       </p>
<p>
        The following description explains how to extract some parameters from ECG, commonly used for heart rate variability analysis (HRV).
       </p>
<p>
<strong>
<span class="color2">
          List of HRV analysis parameters:
         </span>
</strong>
<br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        Minimum, Maximum and Average RR Interval;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        Minimum, Maximum and Average Heart Rate (BPM);
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        SDNN;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        rmsSD;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        NN20, pNN20;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        NN50, pNN50;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        Power inside ULF, VLF, LF and HF Frequency Bands;
        <br/>
<strong>
<span class="color2">
          ☌
         </span>
</strong>
        SD1, SD2, SD1 / SD2;
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        1 - Importation of the needed packages
       </p>
</div>
</div>
</div>
<div class="hide_out">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># biosignalsnotebooks own package for loading and plotting the acquired data</span>
<span class="kn">import</span> <span class="nn">biosignalsnotebooks</span> <span class="k">as</span> <span class="nn">bsnb</span>

<span class="c1"># Scientific packages</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">linspace</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">fabs</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="nb">round</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="k">import</span> <span class="n">simps</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        2 - Load of acquired ECG data
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Load of data</span>
<span class="n">data</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">load_signal</span><span class="p">(</span><span class="s2">"ecg_5_min"</span><span class="p">,</span> <span class="n">get_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        3 - Identification of the channel used during acquisition
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">channel</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">" Channel: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" of "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">"device name"</span><span class="p">])</span> <span class="o">+</span> <span class="s2">" device"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        4 - Storage of sampling frequency and acquired data inside variables
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Sampling frequency and acquired data</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="s2">"sampling rate"</span><span class="p">]</span>

<span class="c1"># Signal Samples</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         5 - Generation of tachogram
        </p>
        Tachogram defines the fundamental structure from where all parameters will be extracted.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">tachogram_data</span><span class="p">,</span> <span class="n">tachogram_time</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">tachogram</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_seconds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tachogram_time</span><span class="p">,</span> <span class="n">tachogram_data</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">'Time (s)'</span><span class="p">,</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">'Cardiac Cycle (s)'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Tachogram"</span><span class="p">,</span>  <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         6 - Removal of ectopic beats
        </p>
        A commonly accepted definition for ectopic beats establishes that a cardiac cycle that differs in at least 20 % of the duration of the previous one, can be considered an ectopic beat that should be removed.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">tachogram_data_NN</span><span class="p">,</span> <span class="n">tachogram_time_NN</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">remove_ectopy</span><span class="p">(</span><span class="n">tachogram_data</span><span class="p">,</span> <span class="n">tachogram_time</span><span class="p">)</span>
<span class="n">bpm_data</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">array</span><span class="p">(</span><span class="n">tachogram_data_NN</span><span class="p">))</span> <span class="o">*</span> <span class="mi">60</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        7 - Comparison between the tachograms obtained before and after ectopic beat removal
       </p>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot_post_ecto_rem_tachogram</span><span class="p">(</span><span class="n">tachogram_time</span><span class="p">,</span> <span class="n">tachogram_data</span><span class="p">,</span> <span class="n">tachogram_time_NN</span><span class="p">,</span> <span class="n">tachogram_data_NN</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<strong>
<span class="color7">
          We can conclude that there are not ectopic beats in the present acquisition
         </span>
</strong>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        8 - Extraction of Parameters
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        8.1 - Time Parameters
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Maximum, Minimum and Average RR Interval</span>
<span class="n">max_rr</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tachogram_data_NN</span><span class="p">)</span>
<span class="n">min_rr</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tachogram_data_NN</span><span class="p">)</span>
<span class="n">avg_rr</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="n">tachogram_data_NN</span><span class="p">)</span>

<span class="c1"># Maximum, Minimum and Average Heart Rate</span>
<span class="n">max_hr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">min_rr</span> <span class="c1"># Cycles per second</span>
<span class="n">max_bpm</span> <span class="o">=</span> <span class="n">max_hr</span> <span class="o">*</span> <span class="mi">60</span> <span class="c1"># BPM</span>

<span class="n">min_hr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">max_rr</span> <span class="c1"># Cycles per second</span>
<span class="n">min_bpm</span> <span class="o">=</span> <span class="n">min_hr</span> <span class="o">*</span> <span class="mi">60</span> <span class="c1"># BPM</span>

<span class="n">avg_hr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">avg_rr</span> <span class="c1"># Cyles per second</span>
<span class="n">avg_bpm</span> <span class="o">=</span> <span class="n">avg_hr</span> <span class="o">*</span> <span class="mi">60</span> <span class="c1"># BPM</span>

<span class="c1"># SDNN</span>
<span class="n">sdnn</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">tachogram_data_NN</span><span class="p">)</span>

<span class="n">time_param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Maximum RR"</span><span class="p">:</span> <span class="n">max_rr</span><span class="p">,</span> <span class="s2">"Minimum RR"</span><span class="p">:</span> <span class="n">min_rr</span><span class="p">,</span> <span class="s2">"Average RR"</span><span class="p">:</span> <span class="n">avg_rr</span><span class="p">,</span> <span class="s2">"Maximum BPM"</span><span class="p">:</span> <span class="n">max_bpm</span><span class="p">,</span> <span class="s2">"Minimum BPM"</span><span class="p">:</span> <span class="n">min_bpm</span><span class="p">,</span> <span class="s2">"Average BPM"</span><span class="p">:</span> <span class="n">avg_bpm</span><span class="p">,</span> <span class="s2">"SDNN"</span><span class="p">:</span> <span class="n">sdnn</span><span class="p">}</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">"[Maximum RR, Minimum RR, Average RR] = ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_rr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_rr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">avg_rr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"] s"</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">"[Maximum BPM, Minimum BPM, Average BPM] = ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_bpm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_bpm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">avg_bpm</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"] BPM"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot_hrv_parameters</span><span class="p">(</span><span class="n">tachogram_time</span><span class="p">,</span> <span class="n">tachogram_data</span><span class="p">,</span> <span class="n">time_param_dict</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        8.2 - Poincaré Parameters
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Auxiliary Structures</span>
<span class="n">tachogram_diff</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">tachogram_data</span><span class="p">)</span>
<span class="n">tachogram_diff_abs</span> <span class="o">=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">tachogram_diff</span><span class="p">)</span>
<span class="n">sdsd</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">tachogram_diff</span><span class="p">)</span>
<span class="n">rr_i</span> <span class="o">=</span> <span class="n">tachogram_data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rr_i_plus_1</span> <span class="o">=</span> <span class="n">tachogram_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># PoincarÃ© Parameters</span>
<span class="n">sd1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="n">sdsd</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sd2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="n">sdnn</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">power</span><span class="p">(</span><span class="n">sd1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sd1_sd2</span> <span class="o">=</span> <span class="n">sd1</span> <span class="o">/</span> <span class="n">sd2</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">"[SD1, SD2] = ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sd1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sd2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"] s"</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">"SD1/SD2 = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sd1_sd2</span><span class="p">))</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot_poincare</span><span class="p">(</span><span class="n">tachogram_data</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        8.3 - Frequency Parameters
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Auxiliary Structures</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">power_spect</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">tachogram_time</span><span class="p">,</span> <span class="n">tachogram_data</span><span class="p">)</span> <span class="c1"># Power spectrum.</span>

<span class="c1"># Frequemcy Parameters</span>
<span class="n">freq_bands</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"ulf_band"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">],</span> <span class="s2">"vlf_band"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">],</span> <span class="s2">"lf_band"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="s2">"hf_band"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">]}</span>
<span class="n">power_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">total_power</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">band_keys</span> <span class="o">=</span> <span class="n">freq_bands</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">band_keys</span><span class="p">:</span>
    <span class="n">freq_band</span> <span class="o">=</span> <span class="n">freq_bands</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>
    <span class="n">freq_samples_inside_band</span> <span class="o">=</span> <span class="p">[</span><span class="n">freq</span> <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">&gt;=</span> <span class="n">freq_band</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">freq_band</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">power_samples_inside_band</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">power_spect</span><span class="p">,</span> <span class="n">freqs</span><span class="p">)</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">&gt;=</span> <span class="n">freq_band</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">freq_band</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">power</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">simps</span><span class="p">(</span><span class="n">power_samples_inside_band</span><span class="p">,</span> <span class="n">freq_samples_inside_band</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
    
    <span class="c1"># Storage of power inside each band</span>
    <span class="n">power_values</span><span class="p">[</span><span class="n">band</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>
    
    <span class="c1"># Total power update</span>
    <span class="n">total_power</span> <span class="o">=</span> <span class="n">total_power</span> <span class="o">+</span> <span class="n">power</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">"Power in [ULF, VLF, LF, HF] Bands = ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_values</span><span class="p">[</span><span class="s2">"ulf_band"</span><span class="p">])</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_values</span><span class="p">[</span><span class="s2">"vlf_band"</span><span class="p">])</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_values</span><span class="p">[</span><span class="s2">"lf_band"</span><span class="p">])</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power_values</span><span class="p">[</span><span class="s2">"hf_band"</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"] s</span><span class="se">\u00B2</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">"Total Power = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">total_power</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" s</span><span class="se">\u00B2</span><span class="s2">"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot_hrv_power_bands</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">power_spect</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        Additional Temporal Parameters
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Number of RR intervals that have a difference in duration, from the previous one, of at least 20 ms</span>
<span class="n">nn20</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tachogram_diff_abs</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mf">0.02</span><span class="p">)</span>
<span class="n">pnn20</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nn20</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tachogram_diff_abs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># Percentage value.</span>

<span class="c1"># Number of RR intervals that have a difference in duration, from the previous one, of at least 50 ms</span>
<span class="n">nn50</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tachogram_diff_abs</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">pnn50</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nn50</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tachogram_diff_abs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># Percentage value.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">"[NN20, pNN20, NN50, pNN50] = ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nn20</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pnn20</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" %, "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nn50</span><span class="p">)</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pnn50</span><span class="p">)</span> <span class="o">+</span> <span class="s2">" %]"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<em>
         This procedure can be automatically done by
         <strong>
          hrv_parameters
         </strong>
         function in
         <strong>
          extract
         </strong>
         module of
         <strong>
<span class="color2">
           biosignalsnotebooks
          </span>
</strong>
         package
        </em>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">dictParameters</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">hrv_parameters</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">dictParameters</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        This set of parameters reveals interesting information about ECG signal, however you can extract much more features during your signal processing journey !
       </p>
<p>
<strong>
<span class="color7">
          We hope that you have enjoyed this guide.
         </span>
<span class="color2">
          biosignalsnotebooks
         </span>
<span class="color4">
          is an environment in continuous expansion, so don"t stop your journey and learn more with the remaining
          <a href="../MainFiles/biosignalsnotebooks_rev.php">
           Notebooks
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</span>
</strong>
        !
       </p>
</div>
</div>
</div>
<div class="hide_mark hide">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color6">
          **Auxiliary Code Segment (should not be replicated by the user)**
         </span>
</p>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">css_style_apply</span><span class="p">()</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c1">// AUTORUN ALL CELLS ON NOTEBOOK-LOAD!</span>
    <span class="nx">require</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">'base/js/namespace'</span><span class="p">,</span> <span class="s1">'jquery'</span><span class="p">],</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">jupyter</span><span class="p">,</span> <span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">jupyter</span><span class="p">.</span><span class="nx">events</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"kernel_ready.Kernel"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Auto-running all cells-below..."</span><span class="p">);</span>
                <span class="nx">jupyter</span><span class="p">.</span><span class="nx">actions</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'jupyter-notebook:run-all-cells-below'</span><span class="p">);</span>
                <span class="nx">jupyter</span><span class="p">.</span><span class="nx">actions</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'jupyter-notebook:save-notebook'</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
