<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>
   unit_conversion_ACC
  </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js">
</script>
<!-- Custom stylesheet, it must be in the same directory as the html file -->
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML">
</script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
  </script>
<!-- End of mathjax configuration -->
<link href="../../styles/bsnb_style.css" rel="stylesheet"/></head>
<body>
<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>

<!--link rel="stylesheet" href="../../styles/header_style.css"-->
</p>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<table width="100%">
<tr>
<td class="header_image_color_4" id="image_td" width="15%">
<div class="header_image_4" id="image_img">
</div>
</td>
<td class="header_text">
          ACC Sensor - Unit Conversion
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="flex-container">
<div class="flex-item" id="diff_level">
<strong>
          Difficulty Level:
         </strong>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
</div>
<div class="flex-item-tag" id="tag">
<span id="tag_list">
<table id="tag_list_table">
<tr>
<td class="shield_left">
             Tags
            </td>
<td class="shield_right" id="tags">
             pre-process☁ACC☁conversion
            </td>
</tr>
</table>
</span>
<!-- [OR] Visit https://img.shields.io in order to create a tag badge-->
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        The
        <strong>
<span class="color2">
          OpenSignals
         </span>
</strong>
        outputted file formats contain raw data, so each sample has a digital unit.
       </p>
<p>
        In scientific terms it is recommended the use of specific units, like electric tension (V) or electric current (A).
Each sensor that PLUX commercialise has a datasheet where a transfer function is mentioned for unit conversion be done.
       </p>
<p>
        The next lines are intended to explain how this conversion can be programmatically done.
       </p>
<p>
        In spite of the unit conversion procedure has some common steps applicable to all sensors, the current
        <strong>
<span class="color5">
          Jupyter Notebook
         </span>
</strong>
        is dedicated to the unit conversion procedure of signals acquired with Accelerometer sensor.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        1 - Importation of the needed packages
       </p>
</div>
</div>
</div>
<div class="hide_out">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># biosignalsnotebooks Python package with useful functions that support and complement the available Notebooks</span>
<span class="kn">import</span> <span class="nn">biosignalsnotebooks</span> <span class="k">as</span> <span class="nn">bsnb</span>

<span class="c1"># Function used for creating a numpy array, where a mathematical operation can be applied to each entry in an easy and automatic way. On the other side, linspace, here will be used for generation of a time-axis.</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">linspace</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        2 - Download of the sensor datasheet (from
        <a href="https://biosignalsplux.com/index.php/learn/documentation">
         https://biosignalsplux.com/index.php/learn/documentation
        </a>
        ). In this case we are working with ACC, being our file located at
        <a href="https://plux.info/datasheets/ACC_Sensor_Datasheet.pdf">
         https://plux.info/datasheets/ACC_Sensor_Datasheet.pdf
        </a>
</p>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Embedding of .pdf file</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="s1">'../../images/pre-process/unit_conversion_ACC/ACC_Sensor_Datasheet.pdf#page=2'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">"100%"</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">"350"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        3 - Extraction of the transfer function from the beginning of the second page
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
       \begin{equation}
ACC{(g)} = \frac{ADC-{C_{min}}}{{C_{max}}-{C_{min}}}\times{2}-{1}
\end{equation}
       <table width="100%">
<tr>
<td style="text-align:left;vertical-align:top" width="25%">
          $ACC{(g)}$ - ACC value in g-force (g)
         </td>
<td style="text-align:left;vertical-align:top" width="25%">
          $ADC$ - Value sampled from the acquisition channel
         </td>
<td style="text-align:left;vertical-align:top" width="25%">
          $C_{min}$ - Minimum calibration value
         </td>
<td style="text-align:left;vertical-align:top" width="25%">
          $C_{max}$ - Maximum calibration value
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Quoting the description available on the sensor datasheet:
       </p>
<p>
<i>
         This sensor requires a calibration to provide reliable measurements. The resulting calibration values ($C_{min}$ and $C_{max}$) which are needed for the transfer function are determined by performing a very slow 360Âº rotation of the sensor around each axis to force the accelerometer to cross the gravity-imposed âˆ’1g and 1g
        </i>
</p>
<p>
        So, $C_{min}$ and $C_{max}$ are the minimum and maximum RAW values registered on each channel during the calibration procedure.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        4 - Loading of data stored in
        <strong>
<span class="color2">
          biosignalsnotebooks
         </span>
</strong>
        own signal library
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Data loading</span>
<span class="n">data</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">load_signal</span><span class="p">(</span><span class="s2">"https://drive.google.com/open?id=1Tky7YNZ95VkFN3F2rxM6Fwf_x2YTMYmx"</span><span class="p">,</span> <span class="n">get_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        In the following cell, some relevant information is stored inside variables. This relevant information includes the mac-address of the device, channel number and signal acquisition parameters such as resolution and sampling rate.
       </p>
<p>
        For a detailed explanation of how to access this info, the
        <a href="../Load/signal_loading_preparatory_steps_rev.php" target="_blank">
         "Signal Loading - Working with File Header"
         <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
        Notebook should be consulted.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">ch_X</span><span class="o">=</span> <span class="s2">"CH1"</span> <span class="c1"># Channel (X-axis)</span>
<span class="n">ch_Y</span> <span class="o">=</span> <span class="s2">"CH2"</span> <span class="c1"># Channel (Y-axis)</span>
<span class="n">ch_Z</span><span class="o">=</span> <span class="s2">"CH3"</span><span class="c1"># Channel (Z-axis)</span>
<span class="n">sr</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># Sampling rate</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># Resolution (number of available bits)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        For our specific case (16 bits acquisition), the calibration values ($C_{min}$ and $C_{max}$) are:
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">c_min</span> <span class="o">=</span> <span class="mi">28000</span>
<span class="n">c_max</span> <span class="o">=</span> <span class="mi">38000</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Access to acquired signal samples and storage inside a new variable.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">signal_X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ch_X</span><span class="p">]</span>
<span class="n">signal_Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ch_Y</span><span class="p">]</span>
<span class="n">signal_Z</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ch_Z</span><span class="p">]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        5 - Final unit conversion (to
        <span class="color5">
         g
        </span>
        ) by applying the transfer function sample by sample
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">signal_X_</span> <span class="o">=</span> <span class="p">((</span><span class="n">array</span><span class="p">(</span><span class="n">signal_X</span><span class="p">)</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_max</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">signal_Y_</span><span class="o">=</span> <span class="p">((</span><span class="n">array</span><span class="p">(</span><span class="n">signal_Y</span><span class="p">)</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_max</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">signal_Z_</span> <span class="o">=</span> <span class="p">((</span><span class="n">array</span><span class="p">(</span><span class="n">signal_Z</span><span class="p">)</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_max</span> <span class="o">-</span> <span class="n">c_min</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        6 - Time axis generation
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [ ]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">bsnb</span><span class="o">.</span><span class="n">generate_time</span><span class="p">(</span><span class="n">signal_X_</span><span class="p">,</span> <span class="n">sr</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Comparison between RAW and mV signal.
       </p>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [ ]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span><span class="n">time</span><span class="p">],</span> <span class="p">[</span><span class="n">signal_X</span><span class="p">,</span> <span class="n">signal_X_</span><span class="p">,</span><span class="n">signal_Y</span><span class="p">,</span><span class="n">signal_Y_</span><span class="p">,</span> <span class="n">signal_Z</span><span class="p">,</span><span class="n">signal_Z_</span><span class="p">],</span> <span class="n">y_axis_label</span><span class="o">=</span><span class="p">[</span><span class="s2">"Raw Data"</span><span class="p">,</span> <span class="s2">"Acceleration (g)"</span><span class="p">,</span> <span class="s2">"Raw Data"</span><span class="p">,</span> <span class="s2">"Acceleration (g)"</span><span class="p">,</span><span class="s2">"Raw Data"</span><span class="p">,</span> <span class="s2">"Acceleration (g)"</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s2">"X Channel (Raw)"</span><span class="p">,</span> <span class="s2">"X Channel (g)"</span><span class="p">,</span> <span class="s2">"Y Channel (Raw)"</span><span class="p">,</span> <span class="s2">"Y Channel (g)"</span><span class="p">,</span> <span class="s2">"Z Channel(RAW)"</span><span class="p">,</span><span class="s2">"Z Channel(g)"</span><span class="p">],</span> <span class="n">grid_lines</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">grid_columns</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">grid_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<strong>
<span class="color2">
          Similar Notebooks
         </span>
         , dedicated to the unit conversion of other sensors, are available in the following "conversion" section of
         <a href="../MainFiles/by_tag_rev.php">
          Notebooks Grouped by Tag page
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</strong>
</p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
<div class="hide_mark hide">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color6">
      **Auxiliary Code Segment (should not be replicated by the user)**
     </span>
</p>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
    In [ ]:
   </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">from</span> <span class="nn">biosignalsnotebooks.__notebook_support__</span> <span class="k">import</span> <span class="n">css_style_apply</span>
<span class="n">css_style_apply</span><span class="p">()</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
    In [ ]:
   </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c1">// AUTORUN ALL CELLS ON NOTEBOOK-LOAD!</span>
    <span class="nx">require</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">'base/js/namespace'</span><span class="p">,</span> <span class="s1">'jquery'</span><span class="p">],</span> 
        <span class="kd">function</span><span class="p">(</span><span class="nx">jupyter</span><span class="p">,</span> <span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">jupyter</span><span class="p">.</span><span class="nx">events</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">"kernel_ready.Kernel"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Auto-running all cells-below..."</span><span class="p">);</span>
                <span class="nx">jupyter</span><span class="p">.</span><span class="nx">actions</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'jupyter-notebook:run-all-cells-below'</span><span class="p">);</span>
                <span class="nx">jupyter</span><span class="p">.</span><span class="nx">actions</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'jupyter-notebook:save-notebook'</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
