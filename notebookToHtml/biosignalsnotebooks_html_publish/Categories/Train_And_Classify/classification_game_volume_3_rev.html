<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>
   classification_game_volume_3
  </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js">
</script>
<!-- Custom stylesheet, it must be in the same directory as the html file -->
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML">
</script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
  </script>
<!-- End of mathjax configuration -->
<link href="../../styles/bsnb_style.css" rel="stylesheet"/></head>
<body>
<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>

<!--link rel="stylesheet" href="../../styles/header_style.css"-->
</p>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<table width="100%">
<tr>
<td class="header_image_color_7" id="image_td" width="15%">
<div class="header_image_7" id="image_img">
</div>
</td>
<td class="header_text">
          Stone, Paper or Scissor Game - Train and Classify [Volume 3]
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="flex-container">
<div class="flex-item" id="diff_level">
<strong>
          Difficulty Level:
         </strong>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
</div>
<div class="flex-item-tag" id="tag">
<span id="tag_list">
<table id="tag_list_table">
<tr>
<td class="shield_left">
             Tags
            </td>
<td class="shield_right" id="tags">
             train_and_classify☁machine-learning☁features☁selection
            </td>
</tr>
</table>
</span>
<!-- [OR] Visit https://img.shields.io in order to create a tag badge-->
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color4">
<strong>
          Previous Notebooks that are part of "Rock, Paper or Scissor Game - Train and Classify" module
         </strong>
</span>
</p>
<ul>
<li>
<a href="classification_game_volume_1_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 1] | Experimental Setup
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
<li>
<a href="classification_game_volume_2_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 2] | Feature Extraction
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
</ul>
<p>
<span class="color7">
<strong>
          Following Notebooks that are part of "Rock, Paper or Scissor Game - Train and Classify" module
         </strong>
</span>
</p>
<ul>
<li>
<a href="classification_game_volume_4_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 4] | Training a Classifier
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
<li>
<a href="../Evaluate/classification_game_volume_5_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 5] | Performance Evaluation
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
</ul>
<table width="100%">
<tr>
<td style="text-align:left;font-size:12pt;border-top:dotted 2px #62C3EE">
<span class="color1">
           ☌
          </span>
          Currently we are in possession of a file containing the feature values for all training examples, as demonstrated on a previously created
          <a href="classification_game_volume_2_rev.php">
           Jupyter Notebook
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
          .
          <br/>
          However, there is a high risk that some of the extracted features are not useful for our classification system. Remember, a good feature is a parameter that has the ability to separate the different classes of our classification system, i.e, a parameter with a characteristic range of values for each available class.
          <br/>
          In order to ensure that the training process of our classifier happens in the most efficient way, these redundant or invariant features should be removed.
          <br/>
          The implicit logic of the last two paragraphs is called
          <span class="color7">
<strong>
            Feature Selection
           </strong>
</span>
          , which will be focused at this
          <span class="color4">
<strong>
            Jupyter Notebook
           </strong>
</span>
          !
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         Starting Point (Setup)
        </p>
<strong>
         List of Available Classes:
        </strong>
<br/>
</p>
<p>
<ol start="0">
<li>
<span class="color1">
<strong>
            "No Action"
           </strong>
</span>
          [When the hand is relaxed]
         </li>
<li>
<span class="color4">
<strong>
            "Paper"
           </strong>
</span>
          [All fingers are extended]
         </li>
<li>
<span class="color7">
<strong>
            "Stone"
           </strong>
</span>
          [All fingers are bent]
         </li>
<li>
<span class="color13">
<strong>
            "Scissor"
           </strong>
</span>
          [Forefinger and middle finger are extended and the remaining ones are bent]
         </li>
</ol>
</p>
<table align="center">
<tr>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_paper.png" style="display:block;height:100%"/>
</td>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_stone.png" style="display:block;height:100%"/>
</td>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_scissor.png" style="display:block;height:100%"/>
</td>
</tr>
<tr>
<td style="text-align:center">
<strong>
           Paper
          </strong>
</td>
<td style="text-align:center">
<strong>
           Stone
          </strong>
</td>
<td style="text-align:center">
<strong>
           Scissor
          </strong>
</td>
</tr>
</table>
<p>
<strong>
         Acquired Data:
        </strong>
<br/>
</p>
<ul>
<li>
         Electromyography (EMG) | 2 muscles | Adductor pollicis and  Flexor digitorum superficialis
        </li>
<li>
         Accelerometer (ACC) | 1 axis | Sensor parallel to the thumb nail (Axis perpendicular)
        </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         Protocol/Feature Extraction
        </p>
<strong>
         Extracted Features
        </strong>
</p>
<ul>
<li>
<span style="color:#E84D0E">
<strong>
           [From] EMG signal
          </strong>
</span>
</li>
<ul>
<li>
          Standard Deviation ☆
         </li>
<li>
          Maximum sampled value ☝
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Zero-crossing_rate">
           Zero-Crossing Rate
          </a>
          ☌
         </li>
<li>
          Standard Deviation of the absolute signal ☇
         </li>
</ul>
<li>
<span style="color:#FDC400">
<strong>
           [From] ACC signal
          </strong>
</span>
</li>
<ul>
<li>
          Average Value ☉
         </li>
<li>
          Standard Deviation ☆
         </li>
<li>
          Maximum sampled value ☝
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Zero-crossing_rate">
           Zero-Crossing Rate
          </a>
          ☌
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Slope">
           Slope of the regression curve
          </a>
          ☍
         </li>
</ul>
</ul>
<p>
<strong>
         Formal definition of parameters
        </strong>
<br/>
        ☝ | Maximum Sample Value of a set of elements is equal to the last element of the sorted set
       </p>
<p>
        ☉ | $\mu = \frac{1}{N}\sum_{i=1}^N (sample_i)$
       </p>
<p>
        ☆ | $\sigma = \sqrt{\frac{1}{N}\sum_{i=1}^N(sample_i - \mu_{signal})^2}$
       </p>
<p>
        ☌ | $zcr = \frac{1}{N - 1}\sum_{i=1}^{N-1}bin(i)$
       </p>
<p>
        ☇ | $\sigma_{abs} = \sqrt{\frac{1}{N}\sum_{i=1}^N(|sample_i| - \mu_{signal_{abs}})^2}$
       </p>
<p>
        ☍ | $m = \frac{\Delta signal}{\Delta t}$
       </p>
<p>
        ... being $N$ the number of acquired samples (that are part of the signal), $sample_i$ the value of the sample number $i$, $signal_{abs}$ the absolute signal, $\Delta signal$ is the difference between the y coordinate of two points of the regression curve and $\Delta t$ the difference between the x (time) coordinate of the same two points of the regression curve.
       </p>
<p>
        ... and
       </p>
<p>
        $bin(i)$ a binary function defined as:
       </p>
<p>
        $bin(i) = \begin{cases} 1, &amp; \mbox{if } signal_i \times signal_{i-1} \leq 0 \\ 0, &amp; \mbox{if } signal_i \times signal_{i-1}&gt;0 \end{cases}$
       </p>
<hr/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         Feature Selection
        </p>
<strong>
         Intro
        </strong>
<br/>
        With
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        we will start to use the resources contained inside an extremely useful
        <span class="color1">
<strong>
          Python
         </strong>
</span>
        package:
        <a href="https://scikit-learn.org/stable/index.html">
         scikit-learn
         <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</p>
<p>
        Like described before,
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        is intended to remove redundant or meaningless parameters which would increase the complexity of the classifier and not always translate into an improved performance. Without this step, the risk of overfitting to the training examples increases, making the classifier less able to categorize a new testing example.
       </p>
<p>
        There are different approaches to feature selection such as
        <span class="color4">
<strong>
          filter methods
         </strong>
</span>
        or
        <span class="color1">
<strong>
          wrapper methods
         </strong>
</span>
        .
       </p>
<p>
        In the first method (
        <span class="color4">
<strong>
          filter methods
         </strong>
</span>
        ), a ranking will be attributed to the features, using, for example, the
        <strong>
         Pearson correlation coefficient
        </strong>
        to evaluate the impact that the feature under analysis has on the target class of the training example, or the
        <strong>
         Mutual Information parameter
        </strong>
        which defines whether two variables convey shared information.
       </p>
<p>
        The least relevant features will be excluded and the classifier will be trained later (for a deeper explanation, please, visit the article of Girish Chandrashekar and Ferat Sahin at
        <a href="https://www.sciencedirect.com/science/article/pii/S0045790613003066">
<strong>
          ScienceDirect
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        ).
       </p>
<p>
        The second methodology (
        <span class="color1">
<strong>
          wrapper methods
         </strong>
</span>
        ) is characterised by the fact that the selection phase includes a classification algorithm, and features will be excluded or selected according to the quality of the trained classifier.
       </p>
<p>
        There are also a third major methodology applicable on
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        , including the so called
        <span class="color13">
<strong>
          embedded methods
         </strong>
</span>
        . Essentially this methods are a combination of
        <span class="color4">
<strong>
          filter
         </strong>
</span>
        and
        <span class="color1">
<strong>
          wrapper
         </strong>
</span>
        , being characterised by the simultaneous execution of
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        and
        <span class="color13">
<strong>
          Training
         </strong>
</span>
        stages.
       </p>
<p>
        One of the most intuitive
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        methods is
        <span class="color1">
<strong>
          Recursive Feature Elimination
         </strong>
</span>
        , which will be used in the current
        <span class="color4">
<strong>
          Jupyter Notebook
         </strong>
</span>
        .
       </p>
<p>
        Essentially the steps of this method consists in:
       </p>
<ol>
<li>
         Original set of training examples is segmented into multiple ($K$) subsets of training examples and test examples
        </li>
        For each one of the $K$ subsets of training/test examples:
        <ol>
<li>
          The training examples are used for training a "virtual" classifier (for example a
          <a href="https://en.wikipedia.org/wiki/Support-vector_machine">
<strong>
            Support Vector Machine
            <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
          )
         </li>
<li>
          The test examples are given as inputs of the trained classifier and the "virtual" classifier quality is estimated
         </li>
</ol>
<li>
         At this point we can estimate the average quality of the $K$ "virtual" classifiers and know the weight of each feature on the training stage
        </li>
<li>
         The feature with a smaller weight is excluded
        </li>
<li>
         Repetition of steps
         <strong>
          1
         </strong>
         ,
         <strong>
          2
         </strong>
         and
         <strong>
          3
         </strong>
         until only one feature remains
        </li>
<li>
         Finally, when the "feature elimination" procedure ends, the set of features that provide a "virtual" classifier with the best average quality (step
         <strong>
          2
         </strong>
         ) define the relevant features to be used during our final training stage
        </li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        0 - Import of the needed packages for a correct execution of the current
        <span class="color4">
         Jupyter Notebook
        </span>
</p>
</div>
</div>
</div>
<div class="hide_out">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [1]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Python package that contains functions specialized on "Machine Learning" tasks.</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">RFECV</span><span class="p">,</span> <span class="n">RFE</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">normalize</span>

<span class="c1"># Package dedicated to the manipulation of json files.</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="k">import</span> <span class="n">loads</span><span class="p">,</span> <span class="n">dump</span>

<span class="c1"># Package containing a diversified set of function for statistical processing and also provide support to array operations.</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="nb">max</span><span class="p">,</span> <span class="n">array</span>

<span class="c1"># biosignalsnotebooks own package that supports some functionalities used on the Jupyter Notebooks.</span>
<span class="kn">import</span> <span class="nn">biosignalsnotebooks</span> <span class="k">as</span> <span class="nn">bsnb</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output hide">
<div class="output_area">
<div class="prompt">
</div>
<div id="77e1bbe4-c8cd-44b9-b97f-2a22b1f0c4f3">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#77e1bbe4-c8cd-44b9-b97f-2a22b1f0c4f3');

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.pydata.org/bokeh/release/bokeh-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-tables-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-gl-1.4.0.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
          </script>
</div>
</div>
<div class="output_area">
<div class="prompt">
</div>
<div id="355c0cc8-6ef8-4b89-ae7f-c52c20b5f392">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#355c0cc8-6ef8-4b89-ae7f-c52c20b5f392');

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.pydata.org/bokeh/release/bokeh-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-tables-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-gl-1.4.0.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
          </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         1 - Loading of the dictionary created on
         <a href="classification_game_volume_2_rev.php">
          Volume 2 of "Classification Game" Jupyter Notebook
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</p>
        This dictionary contains all the features extracted from our training examples.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [2]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Specification of filename and relative path.</span>
<span class="n">relative_path</span> <span class="o">=</span> <span class="s2">"../../signal_samples/classification_game/features"</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">"classification_game_features.json"</span>

<span class="c1"># Load of data inside file storing it inside a Python dictionary.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">relative_path</span> <span class="o">+</span> <span class="s2">"/"</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">features_dict</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [3]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">from</span> <span class="nn">sty</span> <span class="k">import</span> <span class="n">fg</span><span class="p">,</span> <span class="n">rs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mDict Keys</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="s2">" define the class number"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">232</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mDict Sub-Keys</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="s2">" define the trial number</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">features_dict</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(98,195,238)">Dict Keys</span> define the class number
<span class="ansi-bold" style="color: rgb(232,77,14)">Dict Sub-Keys</span> define the trial number

{'0': {'1': [0.002128164580188196, 0.00732421875, 0.3148858143023837, 0.0013299640761190862, 0.00525897736063944, 0.0177154541015625, 0.14585764294049008, 0.0032250390995378314, 0.5878418, 0.004769659606303164, 0.6044, 0.0, 1.4062325168397938e-06], '2': [0.002029433963100043, 0.0075531005859375, 0.3459899981478051, 0.0012865379359157589, 0.00426341220793342, 0.0205078125, 0.24356362289312836, 0.0032271742477853944, 0.5960790740740741, 0.005347679929104084, 0.6175999999999999, 0.0, 1.7843743867526657e-06], '3': [0.004812456585924175, 0.01629638671875, 0.1500312565117733, 0.0027146265743094667, 0.002620978804585002, 0.01263427734375, 0.17816211710773078, 0.0022142130046097727, 0.9737463333333332, 0.008456826821502778, 1.0055999999999998, 0.0, 4.284292720672414e-07], '4': [0.003288393293733703, 0.0120849609375, 0.2182839094577996, 0.001892522517093399, 0.006623739508638536, 0.024169921875, 0.21266888927882086, 0.004546908635468114, 0.4644140350877193, 0.00591195751107905, 0.5671999999999999, 0.0, 5.204352203726982e-07], '5': [0.003974582803167046, 0.01190185546875, 0.18929431376180775, 0.0021560792451752937, 0.015274954840938857, 0.0413360595703125, 0.13502500463048714, 0.008656094595054242, 0.2837205925925926, 0.011517276154508253, 0.3273999999999999, 0.0, 2.2944983716296495e-06]}, '1': {'1': [0.01745991778366743, 0.13330078125, 0.1666919230186392, 0.012498507929444395, 0.008794508626081544, 0.0683441162109375, 0.2518563418699803, 0.006557225017506427, 0.6551165151515151, 0.1461447530029049, 1.5952000000000002, 0.00030307622367025305, -6.71839817994486e-06], '2': [0.01576872398048997, 0.11004638671875, 0.17624797260767705, 0.011874382612913703, 0.007355703497563003, 0.063262939453125, 0.2759055685709137, 0.005353108416775609, 0.664985945945946, 0.22564751043706982, 2.3568, 0.0007208506037123806, 3.0184467432070763e-05], '3': [0.016834862817464734, 0.10711669921875, 0.12385397566261043, 0.010210459675732673, 0.006991805896638525, 0.05291748046875, 0.23737289548258042, 0.005118249131484526, 0.7038323999999999, 0.09012218944433163, 1.2955999999999999, 0.0, 1.7932120498114455e-06], '4': [0.01624700006560064, 0.08184814453125, 0.13230391296718721, 0.010096274630523346, 0.006410319455413151, 0.03900146484375, 0.24232321459905246, 0.004563770456971738, 0.694470701754386, 0.07905537027731246, 1.1703999999999999, 0.0, 1.2355520070555934e-05], '5': [0.020006202433146783, 0.11279296875, 0.1737049068216789, 0.014510097131530179, 0.00870274334484326, 0.0604248046875, 0.2576508804923919, 0.006020127976422262, 0.7650033504273503, 0.18888218438624177, 2.2648, 0.00034193879295606086, -7.484701743981861e-07]}, '2': {'1': [0.03701667312138605, 0.48175048828125, 0.13714182735628042, 0.028527836988579556, 0.00962890534505662, 0.0972747802734375, 0.2526581366011894, 0.007592204871521871, -0.05535329729729731, 0.389147481076091, 1.12, 0.0016219138583528565, -0.00017734880190042993], '2': [0.05605906972012585, 0.728759765625, 0.15079500769362283, 0.04570180889395357, 0.022246936792071167, 0.2032470703125, 0.28363822875705247, 0.0181818341541995, -0.1621129230769231, 0.4012124197110927, 0.7678, 0.0020516327577363653, -0.00018692108787173123], '3': [0.04336534865689463, 0.39495849609375, 0.2081066853834006, 0.03180753348005212, 0.019210994245302326, 0.104644775390625, 0.2675908054044569, 0.013625052459912818, -0.08241263157894738, 0.33346391541823117, 1.7416, 0.0029829794700824705, -0.00014185053469919516], '4': [0.06487298554636435, 0.8785400390625, 0.19967561722832944, 0.05166313713613995, 0.013633174787322466, 0.128814697265625, 0.30762299513425845, 0.009650441229459253, -0.13143430630630631, 0.3800528622757343, 1.1568, 0.002342764462065237, -0.0001757656867122758], '5': [0.04605573833347097, 0.56634521484375, 0.21383160179872848, 0.03490825767448176, 0.022935690711269243, 0.1263427734375, 0.3056287796557606, 0.01751656809433346, -0.037762759689922494, 0.25814329874621555, 1.0832000000000002, 0.0021708792060784617, -0.00010479693645550052]}, '3': {'1': [0.06666059775795927, 0.36566162109375, 0.11758009432428038, 0.03798634625145099, 0.09589783278118581, 0.936767578125, 0.31566108310294355, 0.0724352171785137, -0.28372952845528454, 0.2879444621409897, 0.52, 0.0017889087656529517, -0.00010216214518629092], '2': [0.028400519040188962, 0.36090087890625, 0.11831082236279707, 0.01845200002389393, 0.06906328567307285, 0.3870391845703125, 0.34416139511027527, 0.050492947208441975, -0.2559360683760684, 0.28748525778615397, 0.5438000000000001, 0.001538724568302274, -0.0001163346319399635], '3': [0.026872172099736805, 0.25762939453125, 0.19161771709795206, 0.021019732851432105, 0.09220916129668498, 0.75457763671875, 0.33910144467375775, 0.07045219784614146, -0.3003303492063492, 0.3241576808540921, 0.696, 0.0014287982219399905, -0.00011106434030924326], '4': [0.03224804078389381, 0.36859130859375, 0.14737561976406224, 0.023877465471875494, 0.08250524718428286, 1.1531982421875, 0.32894511882373056, 0.06375121644479873, -0.27145336752136756, 0.29059513319336294, 1.4832, 0.0018806633612583347, -0.00011592650334266791], '5': [0.024408102937141216, 0.19610595703125, 0.1247592235886798, 0.015037408860519162, 0.06386941034280033, 0.44805908203125, 0.3390131871388354, 0.046133417352076656, -0.3375715851851852, 0.30169159148351743, 0.6961999999999999, 0.0010371906949177656, -9.453002551262363e-05]}}
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         2 - Restructuring of "features_dict" to a compatible format of
         <a href="https://scikit-learn.org/stable/index.html">
          scikit-learn
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
         package
        </p>
        features_dict must be converted to a list, containing inside it a number of sub-lists equal to the number of training examples (in our case 20). In its turn, each sub-list is formed by a number of entries equal to the number of extracted features (13 for our original formulation of the problem).
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [4]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Initialisation of a list containing our training data and another list containing the labels of each training example.</span>
<span class="n">features_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">class_training_examples</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Access each feature list inside dictionary.</span>
<span class="n">list_classes</span> <span class="o">=</span> <span class="n">features_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">for</span> <span class="n">class_i</span> <span class="ow">in</span> <span class="n">list_classes</span><span class="p">:</span>
    <span class="n">list_trials</span> <span class="o">=</span> <span class="n">features_dict</span><span class="p">[</span><span class="n">class_i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">list_trials</span><span class="p">:</span>
        <span class="c1"># Storage of the class label.</span>
        <span class="n">class_training_examples</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">class_i</span><span class="p">)]</span>
        <span class="n">features_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">features_dict</span><span class="p">[</span><span class="n">class_i</span><span class="p">][</span><span class="n">trial</span><span class="p">]]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [5]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">232</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1m[Number of list entries;Number of sub-list entries]:</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="s2">" ["</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features_list</span><span class="p">))</span> <span class="o">+</span> <span class="s2">"; "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">"]"</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">'</span><span class="se">\u2713</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">253</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mClass of each training example:</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_training_examples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mFeatures List:</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">features_list</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(232,77,14)">[Number of list entries;Number of sub-list entries]:</span> [20; 13]âœ“
<span class="ansi-bold" style="color: rgb(253,196,0)">Class of each training example:</span>
[0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3]
<span class="ansi-bold" style="color: rgb(98,195,238)">Features List:</span>
[[0.002128164580188196, 0.00732421875, 0.3148858143023837, 0.0013299640761190862, 0.00525897736063944, 0.0177154541015625, 0.14585764294049008, 0.0032250390995378314, 0.5878418, 0.004769659606303164, 0.6044, 0.0, 1.4062325168397938e-06], [0.002029433963100043, 0.0075531005859375, 0.3459899981478051, 0.0012865379359157589, 0.00426341220793342, 0.0205078125, 0.24356362289312836, 0.0032271742477853944, 0.5960790740740741, 0.005347679929104084, 0.6175999999999999, 0.0, 1.7843743867526657e-06], [0.004812456585924175, 0.01629638671875, 0.1500312565117733, 0.0027146265743094667, 0.002620978804585002, 0.01263427734375, 0.17816211710773078, 0.0022142130046097727, 0.9737463333333332, 0.008456826821502778, 1.0055999999999998, 0.0, 4.284292720672414e-07], [0.003288393293733703, 0.0120849609375, 0.2182839094577996, 0.001892522517093399, 0.006623739508638536, 0.024169921875, 0.21266888927882086, 0.004546908635468114, 0.4644140350877193, 0.00591195751107905, 0.5671999999999999, 0.0, 5.204352203726982e-07], [0.003974582803167046, 0.01190185546875, 0.18929431376180775, 0.0021560792451752937, 0.015274954840938857, 0.0413360595703125, 0.13502500463048714, 0.008656094595054242, 0.2837205925925926, 0.011517276154508253, 0.3273999999999999, 0.0, 2.2944983716296495e-06], [0.01745991778366743, 0.13330078125, 0.1666919230186392, 0.012498507929444395, 0.008794508626081544, 0.0683441162109375, 0.2518563418699803, 0.006557225017506427, 0.6551165151515151, 0.1461447530029049, 1.5952000000000002, 0.00030307622367025305, -6.71839817994486e-06], [0.01576872398048997, 0.11004638671875, 0.17624797260767705, 0.011874382612913703, 0.007355703497563003, 0.063262939453125, 0.2759055685709137, 0.005353108416775609, 0.664985945945946, 0.22564751043706982, 2.3568, 0.0007208506037123806, 3.0184467432070763e-05], [0.016834862817464734, 0.10711669921875, 0.12385397566261043, 0.010210459675732673, 0.006991805896638525, 0.05291748046875, 0.23737289548258042, 0.005118249131484526, 0.7038323999999999, 0.09012218944433163, 1.2955999999999999, 0.0, 1.7932120498114455e-06], [0.01624700006560064, 0.08184814453125, 0.13230391296718721, 0.010096274630523346, 0.006410319455413151, 0.03900146484375, 0.24232321459905246, 0.004563770456971738, 0.694470701754386, 0.07905537027731246, 1.1703999999999999, 0.0, 1.2355520070555934e-05], [0.020006202433146783, 0.11279296875, 0.1737049068216789, 0.014510097131530179, 0.00870274334484326, 0.0604248046875, 0.2576508804923919, 0.006020127976422262, 0.7650033504273503, 0.18888218438624177, 2.2648, 0.00034193879295606086, -7.484701743981861e-07], [0.03701667312138605, 0.48175048828125, 0.13714182735628042, 0.028527836988579556, 0.00962890534505662, 0.0972747802734375, 0.2526581366011894, 0.007592204871521871, -0.05535329729729731, 0.389147481076091, 1.12, 0.0016219138583528565, -0.00017734880190042993], [0.05605906972012585, 0.728759765625, 0.15079500769362283, 0.04570180889395357, 0.022246936792071167, 0.2032470703125, 0.28363822875705247, 0.0181818341541995, -0.1621129230769231, 0.4012124197110927, 0.7678, 0.0020516327577363653, -0.00018692108787173123], [0.04336534865689463, 0.39495849609375, 0.2081066853834006, 0.03180753348005212, 0.019210994245302326, 0.104644775390625, 0.2675908054044569, 0.013625052459912818, -0.08241263157894738, 0.33346391541823117, 1.7416, 0.0029829794700824705, -0.00014185053469919516], [0.06487298554636435, 0.8785400390625, 0.19967561722832944, 0.05166313713613995, 0.013633174787322466, 0.128814697265625, 0.30762299513425845, 0.009650441229459253, -0.13143430630630631, 0.3800528622757343, 1.1568, 0.002342764462065237, -0.0001757656867122758], [0.04605573833347097, 0.56634521484375, 0.21383160179872848, 0.03490825767448176, 0.022935690711269243, 0.1263427734375, 0.3056287796557606, 0.01751656809433346, -0.037762759689922494, 0.25814329874621555, 1.0832000000000002, 0.0021708792060784617, -0.00010479693645550052], [0.06666059775795927, 0.36566162109375, 0.11758009432428038, 0.03798634625145099, 0.09589783278118581, 0.936767578125, 0.31566108310294355, 0.0724352171785137, -0.28372952845528454, 0.2879444621409897, 0.52, 0.0017889087656529517, -0.00010216214518629092], [0.028400519040188962, 0.36090087890625, 0.11831082236279707, 0.01845200002389393, 0.06906328567307285, 0.3870391845703125, 0.34416139511027527, 0.050492947208441975, -0.2559360683760684, 0.28748525778615397, 0.5438000000000001, 0.001538724568302274, -0.0001163346319399635], [0.026872172099736805, 0.25762939453125, 0.19161771709795206, 0.021019732851432105, 0.09220916129668498, 0.75457763671875, 0.33910144467375775, 0.07045219784614146, -0.3003303492063492, 0.3241576808540921, 0.696, 0.0014287982219399905, -0.00011106434030924326], [0.03224804078389381, 0.36859130859375, 0.14737561976406224, 0.023877465471875494, 0.08250524718428286, 1.1531982421875, 0.32894511882373056, 0.06375121644479873, -0.27145336752136756, 0.29059513319336294, 1.4832, 0.0018806633612583347, -0.00011592650334266791], [0.024408102937141216, 0.19610595703125, 0.1247592235886798, 0.015037408860519162, 0.06386941034280033, 0.44805908203125, 0.3390131871388354, 0.046133417352076656, -0.3375715851851852, 0.30169159148351743, 0.6961999999999999, 0.0010371906949177656, -9.453002551262363e-05]]
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        2.1 - Normalisation of the features values, ensuring that the training stage is not affected by scale factors
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [6]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">features_list</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">"max"</span><span class="p">)</span> <span class="c1"># axis=0 specifies that each feature is normalised independently from the others </span>
                                                             <span class="c1"># and norm="max" defines that the normalization reference value will be the feature maximum value.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [7]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">features_list</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 0.03192537  0.00833681  0.91010092  0.025743    0.05483938  0.01536202
   0.42380594  0.04452308  0.6036909   0.01188812  0.25644942  0.
   0.04658795]
 [ 0.03044428  0.00859733  1.          0.02490244  0.04445786  0.01778342
   0.70770175  0.04455256  0.61215026  0.0133288   0.26205024  0.
   0.05911565]
 [ 0.07219342  0.0185494   0.43362888  0.05254475  0.02733095  0.01095586
   0.51767025  0.03056818  1.          0.02107818  0.42668024  0.
   0.0141937 ]
 [ 0.04933039  0.01375573  0.63089659  0.03663197  0.06907079  0.02095903
   0.6179336   0.06277207  0.47693534  0.01473523  0.24066531  0.
   0.01724182]
 [ 0.05962417  0.01354731  0.54710921  0.04173342  0.15928363  0.03584471
   0.39233048  0.11950119  0.29137013  0.02870618  0.13891718  0.
   0.07601586]
 [ 0.26192261  0.15172989  0.48178249  0.24192313  0.09170706  0.05926485
   0.73179719  0.09052537  0.67277944  0.3642578   0.67684997  0.10160185
  -0.22257799]
 [ 0.23655239  0.12526053  0.50940193  0.22984246  0.07670354  0.05485869
   0.80167495  0.07390201  0.68291497  0.56241407  1.          0.24165456
   1.        ]
 [ 0.25254593  0.1219258   0.35796982  0.1976353   0.0729089   0.04588758
   0.68971389  0.07065968  0.72280878  0.22462463  0.54972845  0.
   0.05940844]
 [ 0.24372719  0.09316382  0.38239231  0.19542512  0.0668453   0.03382026
   0.70409761  0.06300486  0.71319468  0.19704118  0.49660557  0.
   0.40933371]
 [ 0.30012036  0.12838683  0.50205182  0.28085978  0.09075016  0.05239759
   0.74863388  0.08311051  0.78562899  0.47077851  0.96096402  0.11462995
  -0.02479653]
 [ 0.55530065  0.54835348  0.39637512  0.55218941  0.10040796  0.08435218
   0.7341269   0.10481372 -0.05684571  0.9699288   0.47522064  0.54372277
  -5.87549879]
 [ 0.8409626   0.8295123   0.43583632  0.88461157  0.23198581  0.17624643
   0.82414307  0.25100821 -0.16648373  1.          0.32578072  0.68777971
  -6.19262501]
 [ 0.65053945  0.44956232  0.6014818   0.61567174  0.20032772  0.09074309
   0.77751546  0.18809984 -0.0846346   0.83114056  0.73896809  1.
  -4.69945461]
 [ 0.97318338  1.          0.57711384  1.          0.14216353  0.11170213
   0.89383353  0.13322858 -0.13497797  0.94726096  0.49083503  0.78537733
  -5.82305078]
 [ 0.69089897  0.6446436   0.61802828  0.67568986  0.23916798  0.10955859
   0.88803911  0.24182392 -0.0387809   0.64340805  0.45960625  0.72775533
  -3.4718829 ]
 [ 1.          0.41621509  0.33983669  0.73526983  1.          0.81232137
   0.91718911  1.         -0.2913793   0.71768581  0.22063815  0.59970536
  -3.38459327]
 [ 0.42604657  0.41079617  0.34194868  0.35715988  0.72017567  0.33562242
   1.          0.69707732 -0.26283649  0.71654127  0.23073659  0.51583478
  -3.8541224 ]
 [ 0.40311928  0.29324719  0.55382444  0.40686133  0.9615354   0.65433471
   0.98529774  0.97262355 -0.30842771  0.80794528  0.29531568  0.47898359
  -3.67951963]
 [ 0.48376465  0.41954981  0.42595341  0.46217607  0.86034527  1.
   0.95578738  0.88011355 -0.27877216  0.72429247  0.6293279   0.63046474
  -3.84060125]
 [ 0.36615488  0.22321801  0.36058621  0.29106651  0.66601516  0.38853604
   0.9850413   0.6368921  -0.34667302  0.75194978  0.29540054  0.34770293
  -3.13174402]]
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         3 - Selection of a classification algorithm to wrap in our
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         methodology
        </p>
        A
        <a href="https://en.wikipedia.org/wiki/Support-vector_machine">
<strong>
          Support Vector Machine
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        shares some principles with
        <a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">
<strong>
          k-Nearest Neighbour Classifiers
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        (which we want to use on
        <a href="../Train_and_Classify/classification_game_volume_4_rev.php">
         Jupyter Notebook [volume 4]
         <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
        ), namely the Cartesian logic, given that each example corresponds to a point with a number $N$ of coordinates equivalent to the number of features analysed (13 for our original problem), that is, each feature defines a dimension of the space.
        <br/>
        Because of this "contact point" our "wrapped" classifier will be a Support Vector Machine.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [8]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Creation of a "Support Vector Classifier" supposing that  our classes are linearly separable.</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">"linear"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         4 - Configuration of the
         <span class="color4">
          Recursive Feature Elimination
         </span>
         procedure given as an input our previously created "svc" object
        </p>
        Some inputs need to be given:
       </p>
<ul>
<li>
<strong>
          estimator
         </strong>
         - our previously created
         <i>
          "Support Vector Classifier"
         </i>
         object
        </li>
<li>
<strong>
          step
         </strong>
         - number of features eliminated on each iteration of the recursive algorithm
        </li>
<li>
<strong>
          cv
         </strong>
         - cross-validation method for estimating the quality of the "virtual" classifiers and dividing the original training set into $K$ subsets of training/test examples. The choice result in a
         <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html">
<strong>
           Stratified K-Fold Strategy
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
         ("The folds are made by preserving the percentage of samples for each class")
        </li>
<li>
<strong>
          scoring
         </strong>
         - definition of criteria for qualifying a classifier. For us the best classifier will be the one that achieve a great accuracy on classifying the test examples
        </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [9]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">rfecv</span> <span class="o">=</span> <span class="n">RFECV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svc</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        5 - Execution of the
        <span class="color4">
         Recursive Feature Elimination
        </span>
        procedure
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [10]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Fit data to the model.</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">rfecv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">class_training_examples</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [11]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>RFECV(cv=StratifiedKFold(n_splits=5, random_state=None, shuffle=False),
      estimator=SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None,
                    coef0=0.0, decision_function_shape='ovr', degree=3,
                    gamma='scale', kernel='linear', max_iter=-1,
                    probability=False, random_state=None, shrinking=True,
                    tol=0.001, verbose=False),
      min_features_to_select=1, n_jobs=None, scoring='accuracy', step=1,
      verbose=0)
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         6 - Get the optimal number of features
        </p>
        It will be the smallest number that provides the possibility to obtain a highest cross-validation score.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         6.1 - Get the list of average score of each virtual classifier (1 per Recursive Feature Elimination iteration)
        </p>
        The first element of the list refers to the average score of the trained classifiers when the set of features is 1, while the last one corresponds to the case where all features are taken into consideration.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [12]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Get list of average score of the virtual classifier</span>
<span class="n">avg_scores</span> <span class="o">=</span> <span class="n">rfecv</span><span class="o">.</span><span class="n">grid_scores_</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [13]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">avg_scores</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.4  0.7  0.75 0.8  0.85 0.85 0.9  0.95 0.95 0.95 0.95 0.95 0.95]
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        6.2 - Identification of the maximum score
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [14]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">max_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">avg_scores</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [15]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mMaximum Average Score:</span><span class="se">\033</span><span class="s2">[0m "</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_score</span><span class="p">))</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(98,195,238)">Maximum Average Score:</span> 0.95
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        6.3 - Identification of the smallest feature set that achieve the maximum score
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [16]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="k">for</span> <span class="n">nbr_features</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_scores</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">avg_scores</span><span class="p">[</span><span class="n">nbr_features</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_score</span><span class="p">:</span>
        <span class="n">optimal_nbr_features</span> <span class="o">=</span> <span class="n">nbr_features</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">break</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [17]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mOptimal Number of Features:</span><span class="se">\033</span><span class="s2">[0m "</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">optimal_nbr_features</span><span class="p">))</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(98,195,238)">Optimal Number of Features:</span> 8
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [18]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">bsnb</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rfecv</span><span class="o">.</span><span class="n">grid_scores_</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">avg_scores</span><span class="p">],</span> 
          <span class="n">y_axis_label</span><span class="o">=</span><span class="s2">"Cross validation score (nb of correct classifications)"</span><span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s2">"Number of features selected"</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_html rendered_html output_subarea">
<div class="bk-root" data-root-id="1001" id="69140bc6-f0b7-4441-b529-c99a3929cb83">
</div>
</div>
</div>
<div class="output_area">
<div class="prompt">
</div>
<div id="69755068-b643-430d-ba91-7dadc6b44c67">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#69755068-b643-430d-ba91-7dadc6b44c67');
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"accb0cfd-8a98-46a9-ba63-6c26b07d2fe5":{"roots":{"references":[{"attributes":{"background_fill_color":{"value":"rgb(242, 242, 242)"},"below":[{"id":"1011","type":"LinearAxis"}],"center":[{"id":"1015","type":"Grid"},{"id":"1020","type":"Grid"}],"height":200,"left":[{"id":"1016","type":"LinearAxis"}],"renderers":[{"id":"1037","type":"GlyphRenderer"}],"sizing_mode":"scale_width","title":null,"toolbar":{"id":"1027","type":"Toolbar"},"x_range":{"id":"1003","type":"DataRange1d"},"x_scale":{"id":"1007","type":"LinearScale"},"y_range":{"id":"1005","type":"DataRange1d"},"y_scale":{"id":"1009","type":"LinearScale"}},"id":"1001","subtype":"Figure","type":"Plot"},{"attributes":{"bottom_units":"screen","fill_alpha":{"value":0.5},"fill_color":{"value":"lightgrey"},"left_units":"screen","level":"overlay","line_alpha":{"value":1.0},"line_color":{"value":"black"},"line_dash":[4,4],"line_width":{"value":2},"render_mode":"css","right_units":"screen","top_units":"screen"},"id":"1046","type":"BoxAnnotation"},{"attributes":{},"id":"1017","type":"BasicTicker"},{"attributes":{"data_source":{"id":"1034","type":"ColumnDataSource"},"glyph":{"id":"1035","type":"Line"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1036","type":"Line"},"selection_glyph":null,"view":{"id":"1038","type":"CDSView"}},"id":"1037","type":"GlyphRenderer"},{"attributes":{"callback":null},"id":"1003","type":"DataRange1d"},{"attributes":{"callback":null,"data":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[0.4,0.7,0.75,0.8,0.85,0.85,0.9,0.95,0.95,0.95,0.95,0.95,0.95]},"selected":{"id":"1045","type":"Selection"},"selection_policy":{"id":"1044","type":"UnionRenderers"}},"id":"1034","type":"ColumnDataSource"},{"attributes":{},"id":"1007","type":"LinearScale"},{"attributes":{"callback":null},"id":"1005","type":"DataRange1d"},{"attributes":{},"id":"1012","type":"BasicTicker"},{"attributes":{"axis_label":"Cross validation score (nb of correct classifications)","axis_line_color":{"value":"rgb(150, 150, 150)"},"axis_line_dash":[2,2],"formatter":{"id":"1040","type":"BasicTickFormatter"},"major_label_text_color":{"value":"rgb(88, 88, 88)"},"major_tick_in":0,"major_tick_line_color":{"value":"white"},"major_tick_out":0,"minor_tick_line_color":{"value":"white"},"minor_tick_out":0,"ticker":{"id":"1017","type":"BasicTicker"}},"id":"1016","type":"LinearAxis"},{"attributes":{"axis_label":"Number of features selected","axis_line_color":{"value":"white"},"formatter":{"id":"1042","type":"BasicTickFormatter"},"major_label_text_color":{"value":"rgb(88, 88, 88)"},"major_tick_line_color":{"value":"white"},"minor_tick_line_color":{"value":"white"},"ticker":{"id":"1012","type":"BasicTicker"}},"id":"1011","type":"LinearAxis"},{"attributes":{},"id":"1009","type":"LinearScale"},{"attributes":{"grid_line_color":"rgb(150, 150, 150)","grid_line_dash":[2,2],"ticker":{"id":"1012","type":"BasicTicker"}},"id":"1015","type":"Grid"},{"attributes":{"dimension":1,"grid_line_color":"rgb(150, 150, 150)","grid_line_dash":[2,2],"ticker":{"id":"1017","type":"BasicTicker"}},"id":"1020","type":"Grid"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1036","type":"Line"},{"attributes":{"overlay":{"id":"1046","type":"BoxAnnotation"}},"id":"1023","type":"BoxZoomTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":{"id":"1022","type":"WheelZoomTool"},"active_tap":"auto","logo":null,"tools":[{"id":"1021","type":"PanTool"},{"id":"1022","type":"WheelZoomTool"},{"id":"1023","type":"BoxZoomTool"},{"id":"1025","type":"ResetTool"}]},"id":"1027","type":"Toolbar"},{"attributes":{},"id":"1021","type":"PanTool"},{"attributes":{},"id":"1022","type":"WheelZoomTool"},{"attributes":{},"id":"1025","type":"ResetTool"},{"attributes":{"source":{"id":"1034","type":"ColumnDataSource"}},"id":"1038","type":"CDSView"},{"attributes":{"line_color":"#009EE3","line_width":2,"x":{"field":"x"},"y":{"field":"y"}},"id":"1035","type":"Line"},{"attributes":{},"id":"1040","type":"BasicTickFormatter"},{"attributes":{},"id":"1042","type":"BasicTickFormatter"},{"attributes":{},"id":"1044","type":"UnionRenderers"},{"attributes":{},"id":"1045","type":"Selection"}],"root_ids":["1001"]},"title":"Bokeh Application","version":"1.4.0"}};
  var render_items = [{"docid":"accb0cfd-8a98-46a9-ba63-6c26b07d2fe5","roots":{"1001":"69140bc6-f0b7-4441-b529-c99a3929cb83"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
          </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         7 - Identification of the set of relevant features, taking into consideration the previously determined optimal number
        </p>
        It should be repeated the Recursive Feature Elimination procedure with "RFE" scikit-learn function, specifying the desired number of target features.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [19]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">rfe</span> <span class="o">=</span> <span class="n">RFE</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svc</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features_to_select</span><span class="o">=</span><span class="n">optimal_nbr_features</span><span class="p">)</span>

<span class="c1"># Fit data to the model.</span>
<span class="n">final_selector</span> <span class="o">=</span> <span class="n">rfe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features_list</span><span class="p">,</span> <span class="n">class_training_examples</span><span class="p">)</span>

<span class="c1"># Acception/Rejection Label attributed to each feature.</span>
<span class="n">acception_labels</span> <span class="o">=</span> <span class="n">final_selector</span><span class="o">.</span><span class="n">support_</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [20]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mRelevant Features (True):</span><span class="se">\033</span><span class="s2">[0m "</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acception_labels</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(98,195,238)">Relevant Features (True):</span> 
[ True False  True  True  True False False  True False  True  True False
  True]
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Each training array has the following structure/content:
        <br/>
        [$\sigma_{emg\,flexor}$, $max_{emg\,flexor}$, $zcr_{emg\,flexor}$, $\sigma_{emg\,flexor}^{abs}$, $\sigma_{emg\,adductor}$, $max_{emg\,adductor}$, $zcr_{emg\,adductor}$, $\sigma_{emg\,adductor}^{abs}$, $\mu_{acc\,z}$, $\sigma_{acc\,z}$, $max_{acc\,z}$, $zcr_{acc\,z}$, $m_{acc\,z}$]
       </p>
<p>
        So, the relevant features are:
       </p>
<ul>
<li>
         $\sigma_{emg\,flexor}$
        </li>
<li>
         $zcr_{emg\,flexor}$
        </li>
<li>
         $\sigma_{emg\,flexor}^{abs}$
        </li>
<li>
         $\sigma_{emg\,adductor}$
        </li>
<li>
         $\sigma_{emg\,adductor}^{abs}$
        </li>
<li>
         $\sigma_{acc\,z}$
        </li>
<li>
         $max_{acc\,z}$
        </li>
<li>
         $m_{acc\,z}$
        </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        8 - Removal of meaningless features from our "features_list" list
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [21]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Access each training example and exclude meaningless entries.</span>
<span class="n">final_features_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">example_nbr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">features_list</span><span class="p">)):</span>
    <span class="n">final_features_list</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">features_list</span><span class="p">[</span><span class="n">example_nbr</span><span class="p">])[</span><span class="n">array</span><span class="p">(</span><span class="n">acception_labels</span><span class="p">)])]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        9 - Storage of the final list of features (after
        <i>
         Recursive Feature Elimination
        </i>
        ) inside a .json file
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [22]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">"classification_game_features_final.json"</span>

<span class="c1"># Generation of .json file in our previously mentioned "relative_path".</span>
<span class="c1"># [Generation of new file]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">relative_path</span> <span class="o">+</span> <span class="s2">"/"</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">dump</span><span class="p">({</span><span class="s2">"features_list_final"</span><span class="p">:</span> <span class="n">final_features_list</span><span class="p">,</span> <span class="s2">"class_labels"</span><span class="p">:</span> <span class="n">class_training_examples</span><span class="p">},</span> <span class="n">file</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        We reach the end of the "Classification Game" third volume. After
        <span class="color7">
<strong>
          Feature Selection
         </strong>
</span>
        all training examples are ready to be delivered to our classification algorithm in order to participate on the training process.
       </p>
<p>
        If your are feeling your interest increasing, please jump to the next
        <a href="../Train_And_Classify/classification_game_volume_4_rev.php">
         volume
         <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</p>
<p>
<strong>
<span class="color7">
          We hope that you have enjoyed this guide.
         </span>
<span class="color2">
          biosignalsnotebooks
         </span>
<span class="color4">
          is an environment in continuous expansion, so don"t stop your journey and learn more with the remaining
          <a href="../MainFiles/biosignalsnotebooks_rev.php">
           Notebooks
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</span>
</strong>
        !
       </p>
</div>
</div>
</div>
<div class="hide_mark hide">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color6">
          **Auxiliary Code Segment (should not be replicated by
the user)**
         </span>
</p>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [23]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">from</span> <span class="nn">biosignalsnotebooks.__notebook_support__</span> <span class="k">import</span> <span class="n">css_style_apply</span>
<span class="n">css_style_apply</span><span class="p">()</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output hide">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.................... CSS Style Applied to Jupyter Notebook .........................
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">
          Out[23]:
         </div>
<div class="output_html rendered_html output_subarea output_execute_result">

<div id="style_import">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>