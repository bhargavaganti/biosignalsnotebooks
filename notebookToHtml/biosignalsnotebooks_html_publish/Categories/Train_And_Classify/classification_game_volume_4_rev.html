<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>
   classification_game_volume_4
  </title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js">
</script>
<!-- Custom stylesheet, it must be in the same directory as the html file -->
<!-- Loading mathjax macro -->
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML">
</script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
  </script>
<!-- End of mathjax configuration -->
<link href="../../styles/bsnb_style.css" rel="stylesheet"/></head>
<body>
<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>

<!--link rel="stylesheet" href="../../styles/header_style.css"-->
</p>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<table width="100%">
<tr>
<td class="header_image_color_7" id="image_td" width="15%">
<div class="header_image_7" id="image_img">
</div>
</td>
<td class="header_text">
          Rock, Paper or Scissor Game - Train and Classify [Volume 4]
         </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="flex-container">
<div class="flex-item" id="diff_level">
<strong>
          Difficulty Level:
         </strong>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star checked">
</span>
<span class="fa fa-star">
</span>
<span class="fa fa-star">
</span>
</div>
<div class="flex-item-tag" id="tag">
<span id="tag_list">
<table id="tag_list_table">
<tr>
<td class="shield_left">
             Tags
            </td>
<td class="shield_right" id="tags">
             train_and_classify☁machine-learning☁features☁train☁nearest-neighbour
            </td>
</tr>
</table>
</span>
<!-- [OR] Visit https://img.shields.io in order to create a tag badge-->
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color4">
<strong>
          Previous Notebooks that are part of "Rock, Paper or Scissor Game - Train and Classify" module
         </strong>
</span>
</p>
<ul>
<li>
<a href="classification_game_volume_1_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 1] | Experimental Setup
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
<li>
<a href="classification_game_volume_2_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 2] | Feature Extraction
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
<li>
<a href="classification_game_volume_3_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 3] | Feature Selection
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
</ul>
<p>
<span class="color7">
<strong>
          Following Notebooks that are part of "Rock, Paper or Scissor Game - Train and Classify" module
         </strong>
</span>
</p>
<ul>
<li>
<a href="../Evaluate/classification_game_volume_5_rev.php">
<strong>
           Rock, Paper or Scissor Game - Train and Classify [Volume 5] | Performance Evaluation
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
</li>
</ul>
<p>
<table width="100%">
<tr>
<td style="text-align:left;font-size:12pt;border-top:dotted 2px #62C3EE">
<span class="color1">
            ☌
           </span>
           After the previous three volumes of the
           <span class="color4">
<strong>
             Jupyter Notebook
            </strong>
</span>
           dedicated to our "Classification Game", we are reaching a decisive stage:
           <strong>
<span class="color2">
             Training of Classifier
            </span>
</strong>
           .
           <br/>
           Currently, as demonstrated in the previous
           <a href="classification_game_volume_3_rev.php">
            volume
            <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
           , all the training data (examples and respective features) are ready to be applied to a classification algorithm.
           <br/>
           The choice of classification algorithm resulted in the selection of
           <span class="color13">
<strong>
             k-Nearest Neighbour
            </strong>
</span>
           classifier.
           <br/>
           On current
           <span class="color4">
<strong>
             Jupyter Notebook
            </strong>
</span>
           it will be described relevant steps to achieve our goal of training a
           <span class="color13">
<strong>
             k-Nearest Neighbour
            </strong>
</span>
           classifier.
          </td>
</tr>
</table>
</p>
<hr/>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         Starting Point (Setup)
        </p>
<strong>
         List of Available Classes:
        </strong>
<br/>
</p>
<p>
<ol start="0">
<li>
<span class="color1">
<strong>
            "No Action"
           </strong>
</span>
          [When the hand is relaxed]
         </li>
<li>
<span class="color4">
<strong>
            "Paper"
           </strong>
</span>
          [All fingers are extended]
         </li>
<li>
<span class="color7">
<strong>
            "Rock"
           </strong>
</span>
          [All fingers are flexed]
         </li>
<li>
<span class="color13">
<strong>
            "Scissor"
           </strong>
</span>
          [Forefinger and middle finger are extended and the remaining ones are flexed]
         </li>
</ol>
</p>
<table align="center">
<tr>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_paper.png" style="display:block;height:100%"/>
</td>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_stone.png" style="display:block;height:100%"/>
</td>
<td height="200px">
<img src="../../images/train_and_classify/classification_game_volume_3/classification_game_scissor.png" style="display:block;height:100%"/>
</td>
</tr>
<tr>
<td style="text-align:center">
<strong>
           Paper
          </strong>
</td>
<td style="text-align:center">
<strong>
           Rock
          </strong>
</td>
<td style="text-align:center">
<strong>
           Scissor
          </strong>
</td>
</tr>
</table>
<p>
<strong>
         Acquired Data:
        </strong>
<br/>
</p>
<ul>
<li>
         Electromyography (EMG) | 2 muscles | Adductor pollicis and  Flexor digitorum superficialis
        </li>
<li>
         Accelerometer (ACC) | 1 axis | Sensor parallel to the thumb nail (Axis perpendicular)
        </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         Protocol/Feature Extraction
        </p>
<strong>
         Extracted Features
        </strong>
</p>
<ul>
<li>
<span style="color:#E84D0E">
<strong>
           [From] EMG signal
          </strong>
</span>
</li>
<ul>
<li>
          Standard Deviation ☆
         </li>
<li>
          Maximum sampled value ☝
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Zero-crossing_rate">
           Zero-Crossing Rate
          </a>
          ☌
         </li>
<li>
          Standard Deviation of the absolute signal ☇
         </li>
</ul>
<li>
<span style="color:#FDC400">
<strong>
           [From] ACC signal
          </strong>
</span>
</li>
<ul>
<li>
          Average Value ☉
         </li>
<li>
          Standard Deviation ☆
         </li>
<li>
          Maximum sampled value ☝
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Zero-crossing_rate">
           Zero-Crossing Rate
          </a>
          ☌
         </li>
<li>
<a href="https://en.wikipedia.org/wiki/Slope">
           Slope of the regression curve
          </a>
          ☍
         </li>
</ul>
</ul>
<p>
<strong>
         Formal definition of parameters
        </strong>
<br/>
        ☝ | Maximum Sample Value of a set of elements is equal to the last element of the sorted set
       </p>
<p>
        ☉ | $\mu = \frac{1}{N}\sum_{i=1}^N (sample_i)$
       </p>
<p>
        ☆ | $\sigma = \sqrt{\frac{1}{N}\sum_{i=1}^N(sample_i - \mu_{signal})^2}$
       </p>
<p>
        ☌ | $zcr = \frac{1}{N - 1}\sum_{i=1}^{N-1}bin(i)$
       </p>
<p>
        ☇ | $\sigma_{abs} = \sqrt{\frac{1}{N}\sum_{i=1}^N(|sample_i| - \mu_{signal_{abs}})^2}$
       </p>
<p>
        ☍ | $m = \frac{\Delta signal}{\Delta t}$
       </p>
<p>
        ... being $N$ the number of acquired samples (that are part of the signal), $sample_i$ the value of the sample number $i$, $signal_{abs}$ the absolute signal, $\Delta signal$ is the difference between the y coordinate of two points of the regression curve and $\Delta t$ the difference between the x (time) coordinate of the same two points of the regression curve.
       </p>
<p>
        ... and
       </p>
<p>
        $bin(i)$ a binary function defined as:
       </p>
<p>
        $bin(i) = \begin{cases} 1, &amp; \mbox{if } signal_i \times signal_{i-1} \leq 0 \\ 0, &amp; \mbox{if } signal_i \times signal_{i-1}&gt;0 \end{cases}$
       </p>
<hr/>
</div>
</div>
</div>
<div class="hide_mark hide">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
          Feature Selection
         </p>
<strong>
          Intro
         </strong>
<br/>
         With
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         we will start to use the resources contained inside an extremely useful
         <span class="color1">
<strong>
           Python
          </strong>
</span>
         package:
         <a href="https://scikit-learn.org/stable/index.html">
          scikit-learn
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</p>
<p>
         Like described before,
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         is intended to remove redundant or meaningless parameters which would increase the complexity of the classifier and not always translate into an improved performance. Without this step, the risk of overfitting to the training examples increases, making the classifier less able to categorize a new testing example.
        </p>
<p>
         There are different approaches to feature selection such as
         <span class="color4">
<strong>
           filter methods
          </strong>
</span>
         or
         <span class="color1">
<strong>
           wrapper methods
          </strong>
</span>
         .
        </p>
<p>
         In the first method (
         <span class="color4">
<strong>
           filter methods
          </strong>
</span>
         ), a ranking will be attributed to the features, using the
         <strong>
          Pearson correlation coefficient
         </strong>
         to evaluate the impact that the feature under analysis has on the target class of the training example, or the
         <strong>
          Mutual Information parameter
         </strong>
         which defines whether two variables convey shared information.
        </p>
<p>
         The least relevant features will be excluded and the classifier will be trained later (for a deeper explanation, please, visit the article of Girish Chandrashekar and Ferat Sahin at
         <a href="https://www.sciencedirect.com/science/article/pii/S0045790613003066">
<strong>
           ScienceDirect
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
         ).
        </p>
<p>
         The second methodology (
         <span class="color1">
<strong>
           wrapper methods
          </strong>
</span>
         ) is characterised by the fact that the selection phase includes a classification algorithm, and features will be excluded or selected according to the quality of the trained classifier.
        </p>
<p>
         There are also a third major methodology applicable on
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         , including the so called
         <span class="color1">
<strong>
           embedded methods
          </strong>
</span>
         . Essentially this methods are a combination of
         <span class="color4">
<strong>
           filter
          </strong>
</span>
         and
         <span class="color1">
<strong>
           wrapper
          </strong>
</span>
         , being characterised by the simultaneous execution of
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         and
         <span class="color13">
<strong>
           Training
          </strong>
</span>
         stages.
        </p>
<p>
         One of the most intuitive
         <span class="color7">
<strong>
           Feature Selection
          </strong>
</span>
         methods is
         <span class="color1">
<strong>
           Recursive Feature Elimination
          </strong>
</span>
         , which will be used in the current
         <span class="color4">
<strong>
           Jupyter Notebook
          </strong>
</span>
         .
        </p>
<p>
         Essentially the steps of this method consists in:
        </p>
<ol>
<li>
          Original set of training examples is segmented into multiple ($K$) subsets of training examples and test examples
         </li>
         For each one of the $K$ subsets of training/test examples:
         <ol>
<li>
           The training examples are used for training a "virtual" classifier (for example a
           <a href="https://en.wikipedia.org/wiki/Support-vector_machine">
<strong>
             Support Vector Machine
             <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
           )
          </li>
<li>
           The test examples are given as inputs of the trained classifier and the "virtual" classifier quality is estimated
          </li>
</ol>
<li>
          At this point we can estimate the average quality of the $K$ "virtual" classifiers and know the weight of each feature on the training stage
         </li>
<li>
          The feature with a smaller weight is excluded
         </li>
<li>
          Repetition of steps
          <strong>
           1
          </strong>
          ,
          <strong>
           2
          </strong>
          and
          <strong>
           3
          </strong>
          until only remains one feature
         </li>
<li>
          Finally, when the "feature elimination" procedure ends, the set of features that provide a "virtual" classifier with the best average quality (step
          <strong>
           2
          </strong>
          ) define the relevant features to be used during our final training stage
         </li>
</ol>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p style="font-size:20pt;color:#62C3EE;padding-bottom:5pt">
         k-Nearest Neighbour Classifier
        </p>
<strong>
         Brief Intro
        </strong>
<br/>
        Following a "Cartesian Logic" each training example is formed by a set of features (in our case we have 20 training examples and each training example is composed by 8 features). Each feature can be viewed as a dimension, so, the training example would be reduced to a 8th dimensional point on the
        <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">
<strong>
          Cartesian Coordinate System
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        .
        <br/>
        Thus, the training stage of a
        <span class="color4">
<strong>
          Jupyter Notebook
         </strong>
</span>
        classifier is really simple, consisting in filling the Cartesian Coordinate System with all the training examples/training points.
        <br/>
        For the standard
        <strong>
         Nearest Neighbour
        </strong>
        , when a test example is given as input of the classifier, the returned result/class will be the class of the training example nearest to our new test example.
        <br/>
        On the improved
        <span class="color13">
<strong>
          k-Nearest Neighbour
         </strong>
</span>
        classifier will be selected the $k$ nearest training points of test example. By a voting mechanism the returned class will be the one that has more training examples inside the $k$ set.
        <br/>
        The distance between training points can be estimated through the
        <a href="https://en.wikipedia.org/wiki/Norm_(mathematics)#Euclidean_norm">
<strong>
          Euclidean Norm
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        :
        <br/>
</p>
<p>
<div style="text-align:center">
         $||xy|| = \sqrt{\sum_{i=1}^N (x_{dim\,i} - y_{dim\,i})^2}$
        </div>
        ... being $||xy||$ the Euclidean distance between two $N$ dimensional points, $x_{dim\,i}$ is the value of coordinate $dim\,i$ of point $x$ while $y_{dim\,i}$ is the value of coordinate $dim\,i$ of point $y$.
        <img src="../../images/train_and_classify/classification_game_volume_3/nn_concepts.gif" width="50%"/>
</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        0 - Import of the needed packages for a correct execution of the current
        <span class="color4">
         Jupyter Notebook
        </span>
</p>
</div>
</div>
</div>
<div class="hide_out">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [1]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Python package that contains functions specialized on "Machine Learning" tasks.</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">normalize</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># biosignalsnotebooks own package that supports some functionalities used on the Jupyter Notebooks.</span>
<span class="kn">import</span> <span class="nn">biosignalsnotebooks</span> <span class="k">as</span> <span class="nn">bsnb</span>

<span class="c1"># Package containing a diversified set of function for statistical processing and also provide support to array operations.</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output hide">
<div class="output_area">
<div class="prompt">
</div>
<div id="7e1bdae1-4921-40c3-a757-021d129137ff">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#7e1bdae1-4921-40c3-a757-021d129137ff');

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.pydata.org/bokeh/release/bokeh-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-tables-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-gl-1.4.0.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
          </script>
</div>
</div>
<div class="output_area">
<div class="prompt">
</div>
<div id="a3bd0b20-fbfa-49d0-a4d2-691ac4218d78">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#a3bd0b20-fbfa-49d0-a4d2-691ac4218d78');

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }

  
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById(null);
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  
  var js_urls = ["https://cdn.pydata.org/bokeh/release/bokeh-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-tables-1.4.0.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-gl-1.4.0.min.js"];
  var css_urls = [];
  

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {
    
    
    }
  ];

  function run_inline_js() {
    
    if (root.Bokeh !== undefined || force === true) {
      
    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById(null)).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
          </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color13" style="font-size:30px">
         ⚠
        </span>
        This step was done internally !!! For now don"t be worried about that.
       </p>
<p>
<p class="steps">
         1 - Loading of the dictionary created on
         <a href="classification_game_volume_3_rev.php">
          Volume 3 of "Classification Game" Jupyter Notebook
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
         , containing the selected features
        </p>
        This dictionary is formed by two levels:
       </p>
<ul>
<li>
<span class="color1">
<strong>
           Level 1 | Keys: "features_list_final" and "class_labels"
          </strong>
</span>
</li>
<li>
<span class="color7">
<strong>
           Level 2 | Lists with 20 entries (1/training example)
          </strong>
</span>
</li>
<strong>
         "features_list_final" &gt;&gt;&gt;
        </strong>
        20x8 list containing an entry for each training example (20) and the respective features (8)
        <br/>
<strong>
         "class_labels" &gt;&gt;&gt;
        </strong>
        Each entry of the list contains the number of the class to which the training example belongs
       </ul>
</div>
</div>
</div>
<div class="hide_in hide">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
        In [2]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># Package dedicated to the manipulation of json files.</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="k">import</span> <span class="n">loads</span>

<span class="c1"># Specification of filename and relative path.</span>
<span class="n">relative_path</span> <span class="o">=</span> <span class="s2">"../../signal_samples/classification_game/features"</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">"classification_game_features_final.json"</span>

<span class="c1"># Load of data inside file storing it inside a Python dictionary.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">relative_path</span> <span class="o">+</span> <span class="s2">"/"</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">features_dict</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [3]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">from</span> <span class="nn">sty</span> <span class="k">import</span> <span class="n">fg</span><span class="p">,</span> <span class="n">rs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fg</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">238</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\033</span><span class="s2">[1mDict Keys</span><span class="se">\033</span><span class="s2">[0m"</span> <span class="o">+</span> <span class="n">fg</span><span class="o">.</span><span class="n">rs</span> <span class="o">+</span> <span class="s2">" divides training example in its features and class label"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">features_dict</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold" style="color: rgb(98,195,238)">Dict Keys</span> divides training example in its features and class label
{'features_list_final': [[0.031925374985616504, 0.9101009161769645, 0.025742998777144244, 0.054839376533556014, 0.04452308179859323, 0.011888115551701333, 0.256449422946368, 0.04658795189958139], [0.030444280899922307, 1.0, 0.024902435415904818, 0.0444578577459767, 0.04455255845830009, 0.01332879957443708, 0.2620502376103191, 0.05911564915857292], [0.07219342081806593, 0.43362888324789295, 0.0525447490181641, 0.027330949288138777, 0.03056818341764522, 0.021078178057380218, 0.4266802443991853, 0.014193699889898955], [0.049330390130518584, 0.6308965884168416, 0.03663197053067692, 0.06907079457939581, 0.06277207154998153, 0.014735230567728103, 0.24066530889341478, 0.017241822190301088], [0.05962416985215949, 0.5471092077087795, 0.0417334169911848, 0.15928362923271033, 0.11950118923122219, 0.028706180538483027, 0.1389171758316361, 0.07601586401328263], [0.2619226105211863, 0.4817824905661847, 0.24192313170044227, 0.09170706335093463, 0.09052537250418409, 0.3642577991681853, 0.6768499660556688, -0.22257799297153125], [0.23655239393059876, 0.5094019293944585, 0.22984246159157856, 0.07670354255394725, 0.07390201376193968, 0.5624140713279896, 1.0, 1.0], [0.2525459324350966, 0.3579698150976626, 0.19763530133345586, 0.07290890413125423, 0.07065967813516462, 0.224624625302545, 0.5497284453496266, 0.0594084375961582], [0.24372718835484417, 0.3823923051979892, 0.19542511721497244, 0.06684530056106534, 0.06300485640464787, 0.19704118415436664, 0.49660556687033264, 0.4093337110671792], [0.3001203575429692, 0.5020518158084821, 0.2808597761551712, 0.0907501566245056, 0.08311051186035512, 0.4707785081086301, 0.9609640190088257, -0.02479653404793693], [0.5553006478548456, 0.3963751209296349, 0.5521894056376119, 0.10040795569413238, 0.10481372414210045, 0.9699288006994162, 0.47522063815342847, -5.875498790878059], [0.8409626016807268, 0.4358363204164185, 0.8846115707902636, 0.231985813932135, 0.25100820929950546, 1.0, 0.3257807196198235, -6.192625007957869], [0.6505394508214833, 0.601481795709304, 0.6156717389467581, 0.20032772053500805, 0.1880998358344729, 0.8311405605498298, 0.7389680923285812, -4.699454612489869], [0.9731833756113974, 0.5771138422996525, 1.0, 0.14216353375190308, 0.1332285814188439, 0.9472609610375593, 0.49083503054989824, -5.823050782917777], [0.690898970043693, 0.6180282752202009, 0.6756898556603982, 0.23916797748289673, 0.24182391903602055, 0.6434080453743202, 0.4596062457569587, -3.4718829043892487], [1.0, 0.3398366858976391, 0.7352698337182155, 1.0, 1.0, 0.717685814283452, 0.22063815342837748, -3.384593265268097], [0.4260465701689263, 0.34194867769632836, 0.35715988317299047, 0.7201756668543021, 0.6970773219883378, 0.7165412725587308, 0.23073659198913787, -3.8541223959564994], [0.4031192789075803, 0.5538244403703657, 0.40686133317924583, 0.9615354030688323, 0.972623546810315, 0.8079452801773019, 0.2953156822810591, -3.6795196257542138], [0.4837646506109135, 0.42595341065640907, 0.46217606586597454, 0.8603452736261372, 0.8801135542630651, 0.724292466824971, 0.629327902240326, -3.8406012497506214], [0.36615487646488876, 0.3605862142158899, 0.29106650687691266, 0.666015158950817, 0.6368920968150436, 0.7519497818655793, 0.29540054310930075, -3.1317440244841364]], 'class_labels': [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3]}
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        Selecting a good set of features is a really important stage for training an effective classification system. For now we are simply loading the selected set of features without explaining the real reason for choosing them (we strongly recommend to read the content of
        <a href="classification_game_volume_3_rev.php">
<strong>
          Rock, Paper or Scissor Game - Train and Classify [Volume 3] | Feature Selection
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        ).
       </p>
<p>
        In order to understand the relevance of selecting a valuable set of features (and how this choice can affect the performance of our classifier), our last volume of "Classification Game" (
        <a href="../Evaluate/classification_game_volume_5_rev.php">
<strong>
          Rock, Paper or Scissor Game - Train and Classify [Volume 5] | Performance Evaluation
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        ) can be a useful resource to go deeper into this question !
       </p>
<p>
<span class="color1">
<strong>
          Set of Features A
         </strong>
</span>
</p>
<ul>
<li>
         $\sigma_{emg\,flexor}$
        </li>
<li>
         $zcr_{emg\,flexor}$
        </li>
<li>
         $\sigma_{emg\,flexor}^{abs}$
        </li>
<li>
         $\sigma_{emg\,adductor}$
        </li>
<li>
         $\sigma_{emg\,adductor}^{abs}$
        </li>
<li>
         $\sigma_{acc\,z}$
        </li>
<li>
         $max_{acc\,z}$
        </li>
<li>
         $m_{acc\,z}$
        </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<p class="steps">
         2 - Storage of content of the dictionary into individual variables
        </p>
        In the previously mentioned internal step (of loading the dictionary created on
        <a href="classification_game_volume_3_rev.php">
<strong>
          Rock, Paper or Scissor Game - Train and Classify [Volume 3] | Feature Selection
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</strong>
</a>
        ) data was stored in
        <strong>
<span class="color7">
          features_dict
         </span>
</strong>
        variable.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [4]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">training_examples</span> <span class="o">=</span> <span class="n">features_dict</span><span class="p">[</span><span class="s2">"features_list_final"</span><span class="p">]</span>
<span class="n">class_training_examples</span> <span class="o">=</span> <span class="n">features_dict</span><span class="p">[</span><span class="s2">"class_labels"</span><span class="p">]</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color7">
         Checkpoint !!!
        </span>
        Currently all the information needed for training our classifier is stored on the following variables:
       </p>
<p>
<ul>
<li>
<strong>
           training_examples
          </strong>
          (list where each entry is a sublist representative of a training example, containing the respective feature values for
          <span class="color1">
           set A
          </span>
          )
         </li>
<li>
<strong>
           class_training_examples
          </strong>
          (list where each entry contains the class label linked to each training example)
         </li>
</ul>
</p>
<p>
<p class="steps">
         3 - Creation of a "k-Nearest Neighbour"
         <a href="https://scikit-learn.org/stable/index.html">
          scikit-learn
          <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
         objects
        </p>
        We use the predefined $k$ (number of neighbours) which is 5.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [5]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># k-Nearest Neighbour object initialisation.</span>
<span class="n">knn_classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        4 - Begin the training stage of classifier (fitting model to data)
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [6]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="n">knn_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_examples</span><span class="p">,</span> <span class="n">class_training_examples</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">
         Out[6]:
        </div>
<div class="output_text output_subarea output_execute_result">
<pre>KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
                     metric_params=None, n_jobs=None, n_neighbors=5, p=2,
                     weights='uniform')</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        The following interactive plot ensures a deep understanding about the class separation provided by each pair of dimensions/features.
       </p>
</div>
</div>
</div>
<div class="hide_in">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [7]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span>

<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="k">import</span> <span class="n">layout</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="k">import</span> <span class="n">CustomJS</span><span class="p">,</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">Select</span><span class="p">,</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">WidgetBox</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="k">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span>

<span class="n">tools</span> <span class="o">=</span> <span class="s1">'pan'</span>
<span class="n">features_identifiers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"std_emg_flexor"</span><span class="p">,</span> <span class="s2">"zcr_emg_flexor"</span><span class="p">,</span> <span class="s2">"std_abs_emg_flexor"</span><span class="p">,</span> <span class="s2">"std_emg_adductor"</span><span class="p">,</span> <span class="s2">"std_abs_emg_adductor"</span><span class="p">,</span> <span class="s2">"std_acc_z"</span><span class="p">,</span> <span class="s2">"max_acc_z"</span><span class="p">,</span> <span class="s2">"m_acc_z"</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">slider</span><span class="p">():</span>
    <span class="n">dict_features</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">feature_nbr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_examples</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="n">values_feature</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">training_examples</span><span class="p">)[:,</span> <span class="n">feature_nbr</span><span class="p">]</span>
        
        <span class="c1"># Fill of dict.</span>
        <span class="k">for</span> <span class="n">class_of_example</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_training_examples</span><span class="p">)):</span>
            <span class="n">current_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dict_features</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_keys</span><span class="p">:</span>
                <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="n">current_sub_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">features_identifiers</span><span class="p">[</span><span class="n">feature_nbr</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sub_keys</span><span class="p">:</span>
                <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="n">features_identifiers</span><span class="p">[</span><span class="n">feature_nbr</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="n">features_identifiers</span><span class="p">[</span><span class="n">feature_nbr</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">values_feature</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]]</span>
            
            <span class="c1"># Add of two additional keys that will store the data currently being ploted.</span>
            <span class="k">if</span> <span class="n">feature_nbr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">"x"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sub_keys</span><span class="p">:</span>
                    <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="s2">"x"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="s2">"x"</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">values_feature</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="n">feature_nbr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">"y"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_sub_keys</span><span class="p">:</span>
                    <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">dict_features</span><span class="p">[</span><span class="n">class_training_examples</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]][</span><span class="s2">"y"</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">values_feature</span><span class="p">[</span><span class="n">class_of_example</span><span class="p">]]</span>
        
    <span class="n">source_class_0</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_features</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">source_class_1</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_features</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">source_class_2</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_features</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">source_class_3</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_features</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="n">plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">tools</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">toolbar_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Pairing Classification Dimensions"</span><span class="p">)</span>
    <span class="n">bsnb</span><span class="o">.</span><span class="n">opensignals_style</span><span class="p">([</span><span class="n">plot</span><span class="p">])</span>
    
    <span class="c1"># Define different colours for points of each class.</span>
    <span class="c1"># [Class 0]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source_class_0</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
    <span class="c1"># [Class 1]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source_class_1</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"green"</span><span class="p">)</span>
    <span class="c1"># [Class 2]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source_class_2</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"orange"</span><span class="p">)</span>
    <span class="c1"># [Class 3]</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source_class_3</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span>

    <span class="n">callback</span> <span class="o">=</span> <span class="n">CustomJS</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="n">source_class_0</span><span class="p">,</span> <span class="n">source_class_1</span><span class="p">,</span> <span class="n">source_class_2</span><span class="p">,</span> <span class="n">source_class_3</span><span class="p">]),</span> <span class="n">code</span><span class="o">=</span><span class="s2">"""</span>
<span class="s2">        // Each class has an independent data structure.</span>
<span class="s2">        var data_0 = source[0].data;</span>
<span class="s2">        var data_1 = source[1].data;</span>
<span class="s2">        var data_2 = source[2].data;</span>
<span class="s2">        var data_3 = source[3].data;</span>
<span class="s2">        </span>
<span class="s2">        // Selected values in the interface.</span>
<span class="s2">        var feature_identifier_x = x_feature.value;</span>
<span class="s2">        var feature_identifier_y = y_feature.value;</span>
<span class="s2">        console.log("x_feature: " + feature_identifier_x);</span>
<span class="s2">        console.log("y_feature: " + feature_identifier_y);</span>
<span class="s2">        </span>
<span class="s2">        // Update of values.</span>
<span class="s2">        var x_0 = data_0["x"];</span>
<span class="s2">        var y_0 = data_0["y"];</span>
<span class="s2">        for (var i = 0; i &lt; x_0.length; i++) {</span>
<span class="s2">            x_0[i] = data_0[feature_identifier_x][i];</span>
<span class="s2">            y_0[i] = data_0[feature_identifier_y][i];</span>
<span class="s2">        }</span>
<span class="s2">        </span>
<span class="s2">        var x_1 = data_1["x"];</span>
<span class="s2">        var y_1 = data_1["y"];</span>
<span class="s2">        for (var i = 0; i &lt; x_1.length; i++) {</span>
<span class="s2">            x_1[i] = data_1[feature_identifier_x][i];</span>
<span class="s2">            y_1[i] = data_1[feature_identifier_y][i];</span>
<span class="s2">        }</span>
<span class="s2">        </span>
<span class="s2">        var x_2 = data_2["x"];</span>
<span class="s2">        var y_2 = data_2["y"];</span>
<span class="s2">        for (var i = 0; i &lt; x_2.length; i++) {</span>
<span class="s2">            x_2[i] = data_2[feature_identifier_x][i];</span>
<span class="s2">            y_2[i] = data_2[feature_identifier_y][i];</span>
<span class="s2">        }</span>
<span class="s2">        </span>
<span class="s2">        var x_3 = data_3["x"];</span>
<span class="s2">        var y_3 = data_3["y"];</span>
<span class="s2">        for (var i = 0; i &lt; x_3.length; i++) {</span>
<span class="s2">            x_3[i] = data_3[feature_identifier_x][i];</span>
<span class="s2">            y_3[i] = data_3[feature_identifier_y][i];</span>
<span class="s2">        }</span>
<span class="s2">        </span>
<span class="s2">        // Communicate update.</span>
<span class="s2">        source[0].change.emit();</span>
<span class="s2">        source[1].change.emit();</span>
<span class="s2">        source[2].change.emit();</span>
<span class="s2">        source[3].change.emit();</span>
<span class="s2">    """</span><span class="p">)</span>

    <span class="n">x_feature_select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Select the Feature of Axis x:"</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">"std_emg_flexor"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">features_identifiers</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">callback</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s2">"x_feature"</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_feature_select</span>
    
    <span class="n">y_feature_select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Select the Feature of Axis y:"</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">"zcr_emg_flexor"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">features_identifiers</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">callback</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s2">"y_feature"</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_feature_select</span>

    <span class="n">widgets</span> <span class="o">=</span> <span class="n">WidgetBox</span><span class="p">(</span><span class="n">x_feature_select</span><span class="p">,</span> <span class="n">y_feature_select</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">widgets</span><span class="p">,</span> <span class="n">plot</span><span class="p">]</span>

<span class="n">l</span> <span class="o">=</span> <span class="n">layout</span><span class="p">([</span><span class="n">slider</span><span class="p">(),],</span> <span class="n">sizing_mode</span><span class="o">=</span><span class="s1">'scale_width'</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_html rendered_html output_subarea">
<div class="bk-root" data-root-id="1060" id="e4e80e78-ff03-4892-8059-a6efbd13af23">
</div>
</div>
</div>
<div class="output_area">
<div class="prompt">
</div>
<div id="19f8a2ce-1350-4075-aa99-93643d87c99c">
</div>
<div class="output_subarea output_javascript">
<script type="text/javascript">
           var element = $('#19f8a2ce-1350-4075-aa99-93643d87c99c');
(function(root) {
  function embed_document(root) {
    
  var docs_json = {"907d6c98-1b43-459a-a224-51b7858c66b5":{"roots":{"references":[{"attributes":{"children":[{"id":"1059","type":"Row"}],"sizing_mode":"scale_width"},"id":"1060","type":"Column"},{"attributes":{},"id":"1031","type":"BasicTickFormatter"},{"attributes":{},"id":"1070","type":"UnionRenderers"},{"attributes":{},"id":"1071","type":"Selection"},{"attributes":{},"id":"1072","type":"UnionRenderers"},{"attributes":{},"id":"1073","type":"Selection"},{"attributes":{"data_source":{"id":"1001","type":"ColumnDataSource"},"glyph":{"id":"1036","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1037","type":"Circle"},"selection_glyph":null,"view":{"id":"1039","type":"CDSView"}},"id":"1038","type":"GlyphRenderer"},{"attributes":{"fill_color":{"value":"green"},"line_alpha":{"value":0.6},"line_color":{"value":"green"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1041","type":"Circle"},{"attributes":{"source":{"id":"1002","type":"ColumnDataSource"}},"id":"1044","type":"CDSView"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1047","type":"Circle"},{"attributes":{"data_source":{"id":"1002","type":"ColumnDataSource"},"glyph":{"id":"1041","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1042","type":"Circle"},"selection_glyph":null,"view":{"id":"1044","type":"CDSView"}},"id":"1043","type":"GlyphRenderer"},{"attributes":{"fill_color":{"value":"orange"},"line_alpha":{"value":0.6},"line_color":{"value":"orange"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1046","type":"Circle"},{"attributes":{"source":{"id":"1003","type":"ColumnDataSource"}},"id":"1049","type":"CDSView"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1052","type":"Circle"},{"attributes":{"data_source":{"id":"1003","type":"ColumnDataSource"},"glyph":{"id":"1046","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1047","type":"Circle"},"selection_glyph":null,"view":{"id":"1049","type":"CDSView"}},"id":"1048","type":"GlyphRenderer"},{"attributes":{"callback":null,"data":{"m_acc_z":[0.04658795189958139,0.05911564915857292,0.014193699889898955,0.017241822190301088,0.07601586401328263],"max_acc_z":[0.256449422946368,0.2620502376103191,0.4266802443991853,0.24066530889341478,0.1389171758316361],"std_abs_emg_adductor":[0.04452308179859323,0.04455255845830009,0.03056818341764522,0.06277207154998153,0.11950118923122219],"std_abs_emg_flexor":[0.025742998777144244,0.024902435415904818,0.0525447490181641,0.03663197053067692,0.0417334169911848],"std_acc_z":[0.011888115551701333,0.01332879957443708,0.021078178057380218,0.014735230567728103,0.028706180538483027],"std_emg_adductor":[0.054839376533556014,0.0444578577459767,0.027330949288138777,0.06907079457939581,0.15928362923271033],"std_emg_flexor":[0.031925374985616504,0.030444280899922307,0.07219342081806593,0.049330390130518584,0.05962416985215949],"x":[0.031925374985616504,0.030444280899922307,0.07219342081806593,0.049330390130518584,0.05962416985215949],"y":[0.9101009161769645,1.0,0.43362888324789295,0.6308965884168416,0.5471092077087795],"zcr_emg_flexor":[0.9101009161769645,1.0,0.43362888324789295,0.6308965884168416,0.5471092077087795]},"selected":{"id":"1067","type":"Selection"},"selection_policy":{"id":"1066","type":"UnionRenderers"}},"id":"1001","type":"ColumnDataSource"},{"attributes":{"fill_color":{"value":"blue"},"line_alpha":{"value":0.6},"line_color":{"value":"blue"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1051","type":"Circle"},{"attributes":{"fill_color":{"value":"red"},"line_alpha":{"value":0.6},"line_color":{"value":"red"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1036","type":"Circle"},{"attributes":{"source":{"id":"1004","type":"ColumnDataSource"}},"id":"1054","type":"CDSView"},{"attributes":{"callback":null,"data":{"m_acc_z":[-0.22257799297153125,1.0,0.0594084375961582,0.4093337110671792,-0.02479653404793693],"max_acc_z":[0.6768499660556688,1.0,0.5497284453496266,0.49660556687033264,0.9609640190088257],"std_abs_emg_adductor":[0.09052537250418409,0.07390201376193968,0.07065967813516462,0.06300485640464787,0.08311051186035512],"std_abs_emg_flexor":[0.24192313170044227,0.22984246159157856,0.19763530133345586,0.19542511721497244,0.2808597761551712],"std_acc_z":[0.3642577991681853,0.5624140713279896,0.224624625302545,0.19704118415436664,0.4707785081086301],"std_emg_adductor":[0.09170706335093463,0.07670354255394725,0.07290890413125423,0.06684530056106534,0.0907501566245056],"std_emg_flexor":[0.2619226105211863,0.23655239393059876,0.2525459324350966,0.24372718835484417,0.3001203575429692],"x":[0.2619226105211863,0.23655239393059876,0.2525459324350966,0.24372718835484417,0.3001203575429692],"y":[0.4817824905661847,0.5094019293944585,0.3579698150976626,0.3823923051979892,0.5020518158084821],"zcr_emg_flexor":[0.4817824905661847,0.5094019293944585,0.3579698150976626,0.3823923051979892,0.5020518158084821]},"selected":{"id":"1069","type":"Selection"},"selection_policy":{"id":"1068","type":"UnionRenderers"}},"id":"1002","type":"ColumnDataSource"},{"attributes":{"callback":{"id":"1055","type":"CustomJS"},"options":["std_emg_flexor","zcr_emg_flexor","std_abs_emg_flexor","std_emg_adductor","std_abs_emg_adductor","std_acc_z","max_acc_z","m_acc_z"],"title":"Select the Feature of Axis y:","value":"zcr_emg_flexor"},"id":"1057","type":"Select"},{"attributes":{"data_source":{"id":"1004","type":"ColumnDataSource"},"glyph":{"id":"1051","type":"Circle"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1052","type":"Circle"},"selection_glyph":null,"view":{"id":"1054","type":"CDSView"}},"id":"1053","type":"GlyphRenderer"},{"attributes":{"callback":null,"data":{"m_acc_z":[-5.875498790878059,-6.192625007957869,-4.699454612489869,-5.823050782917777,-3.4718829043892487],"max_acc_z":[0.47522063815342847,0.3257807196198235,0.7389680923285812,0.49083503054989824,0.4596062457569587],"std_abs_emg_adductor":[0.10481372414210045,0.25100820929950546,0.1880998358344729,0.1332285814188439,0.24182391903602055],"std_abs_emg_flexor":[0.5521894056376119,0.8846115707902636,0.6156717389467581,1.0,0.6756898556603982],"std_acc_z":[0.9699288006994162,1.0,0.8311405605498298,0.9472609610375593,0.6434080453743202],"std_emg_adductor":[0.10040795569413238,0.231985813932135,0.20032772053500805,0.14216353375190308,0.23916797748289673],"std_emg_flexor":[0.5553006478548456,0.8409626016807268,0.6505394508214833,0.9731833756113974,0.690898970043693],"x":[0.5553006478548456,0.8409626016807268,0.6505394508214833,0.9731833756113974,0.690898970043693],"y":[0.3963751209296349,0.4358363204164185,0.601481795709304,0.5771138422996525,0.6180282752202009],"zcr_emg_flexor":[0.3963751209296349,0.4358363204164185,0.601481795709304,0.5771138422996525,0.6180282752202009]},"selected":{"id":"1071","type":"Selection"},"selection_policy":{"id":"1070","type":"UnionRenderers"}},"id":"1003","type":"ColumnDataSource"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1037","type":"Circle"},{"attributes":{"args":{"source":[{"id":"1001","type":"ColumnDataSource"},{"id":"1002","type":"ColumnDataSource"},{"id":"1003","type":"ColumnDataSource"},{"id":"1004","type":"ColumnDataSource"}],"x_feature":{"id":"1056","type":"Select"},"y_feature":{"id":"1057","type":"Select"}},"code":"\n        // Each class has an independent data structure.\n        var data_0 = source[0].data;\n        var data_1 = source[1].data;\n        var data_2 = source[2].data;\n        var data_3 = source[3].data;\n        \n        // Selected values in the interface.\n        var feature_identifier_x = x_feature.value;\n        var feature_identifier_y = y_feature.value;\n        console.log(\"x_feature: \" + feature_identifier_x);\n        console.log(\"y_feature: \" + feature_identifier_y);\n        \n        // Update of values.\n        var x_0 = data_0[\"x\"];\n        var y_0 = data_0[\"y\"];\n        for (var i = 0; i < x_0.length; i++) {\n            x_0[i] = data_0[feature_identifier_x][i];\n            y_0[i] = data_0[feature_identifier_y][i];\n        }\n        \n        var x_1 = data_1[\"x\"];\n        var y_1 = data_1[\"y\"];\n        for (var i = 0; i < x_1.length; i++) {\n            x_1[i] = data_1[feature_identifier_x][i];\n            y_1[i] = data_1[feature_identifier_y][i];\n        }\n        \n        var x_2 = data_2[\"x\"];\n        var y_2 = data_2[\"y\"];\n        for (var i = 0; i < x_2.length; i++) {\n            x_2[i] = data_2[feature_identifier_x][i];\n            y_2[i] = data_2[feature_identifier_y][i];\n        }\n        \n        var x_3 = data_3[\"x\"];\n        var y_3 = data_3[\"y\"];\n        for (var i = 0; i < x_3.length; i++) {\n            x_3[i] = data_3[feature_identifier_x][i];\n            y_3[i] = data_3[feature_identifier_y][i];\n        }\n        \n        // Communicate update.\n        source[0].change.emit();\n        source[1].change.emit();\n        source[2].change.emit();\n        source[3].change.emit();\n    "},"id":"1055","type":"CustomJS"},{"attributes":{"callback":null,"data":{"m_acc_z":[-3.384593265268097,-3.8541223959564994,-3.6795196257542138,-3.8406012497506214,-3.1317440244841364],"max_acc_z":[0.22063815342837748,0.23073659198913787,0.2953156822810591,0.629327902240326,0.29540054310930075],"std_abs_emg_adductor":[1.0,0.6970773219883378,0.972623546810315,0.8801135542630651,0.6368920968150436],"std_abs_emg_flexor":[0.7352698337182155,0.35715988317299047,0.40686133317924583,0.46217606586597454,0.29106650687691266],"std_acc_z":[0.717685814283452,0.7165412725587308,0.8079452801773019,0.724292466824971,0.7519497818655793],"std_emg_adductor":[1.0,0.7201756668543021,0.9615354030688323,0.8603452736261372,0.666015158950817],"std_emg_flexor":[1.0,0.4260465701689263,0.4031192789075803,0.4837646506109135,0.36615487646488876],"x":[1.0,0.4260465701689263,0.4031192789075803,0.4837646506109135,0.36615487646488876],"y":[0.3398366858976391,0.34194867769632836,0.5538244403703657,0.42595341065640907,0.3605862142158899],"zcr_emg_flexor":[0.3398366858976391,0.34194867769632836,0.5538244403703657,0.42595341065640907,0.3605862142158899]},"selected":{"id":"1073","type":"Selection"},"selection_policy":{"id":"1072","type":"UnionRenderers"}},"id":"1004","type":"ColumnDataSource"},{"attributes":{"children":[{"id":"1058","type":"WidgetBox"},{"id":"1005","subtype":"Figure","type":"Plot"}],"sizing_mode":"scale_width"},"id":"1059","type":"Row"},{"attributes":{"children":[{"id":"1056","type":"Select"},{"id":"1057","type":"Select"}],"sizing_mode":"scale_width"},"id":"1058","type":"WidgetBox"},{"attributes":{"callback":{"id":"1055","type":"CustomJS"},"options":["std_emg_flexor","zcr_emg_flexor","std_abs_emg_flexor","std_emg_adductor","std_abs_emg_adductor","std_acc_z","max_acc_z","m_acc_z"],"title":"Select the Feature of Axis x:","value":"std_emg_flexor"},"id":"1056","type":"Select"},{"attributes":{"background_fill_color":{"value":"rgb(242, 242, 242)"},"below":[{"id":"1016","type":"LinearAxis"}],"center":[{"id":"1020","type":"Grid"},{"id":"1025","type":"Grid"}],"height":200,"left":[{"id":"1021","type":"LinearAxis"}],"renderers":[{"id":"1038","type":"GlyphRenderer"},{"id":"1043","type":"GlyphRenderer"},{"id":"1048","type":"GlyphRenderer"},{"id":"1053","type":"GlyphRenderer"}],"sizing_mode":"scale_width","title":{"id":"1006","type":"Title"},"toolbar":{"id":"1026","type":"Toolbar"},"toolbar_location":"right","x_range":{"id":"1008","type":"Range1d"},"x_scale":{"id":"1012","type":"LinearScale"},"y_range":{"id":"1010","type":"Range1d"},"y_scale":{"id":"1014","type":"LinearScale"}},"id":"1005","subtype":"Figure","type":"Plot"},{"attributes":{"text":"Pairing Classification Dimensions"},"id":"1006","type":"Title"},{"attributes":{},"id":"1017","type":"BasicTicker"},{"attributes":{},"id":"1012","type":"LinearScale"},{"attributes":{"callback":null,"end":1.5,"start":-1.5},"id":"1008","type":"Range1d"},{"attributes":{"axis_line_color":{"value":"white"},"formatter":{"id":"1031","type":"BasicTickFormatter"},"major_label_text_color":{"value":"rgb(88, 88, 88)"},"major_tick_line_color":{"value":"white"},"minor_tick_line_color":{"value":"white"},"ticker":{"id":"1017","type":"BasicTicker"}},"id":"1016","type":"LinearAxis"},{"attributes":{},"id":"1014","type":"LinearScale"},{"attributes":{"callback":null,"end":1.5,"start":-1.5},"id":"1010","type":"Range1d"},{"attributes":{"grid_line_color":"rgb(150, 150, 150)","grid_line_dash":[2,2],"ticker":{"id":"1017","type":"BasicTicker"}},"id":"1020","type":"Grid"},{"attributes":{"axis_line_color":{"value":"rgb(150, 150, 150)"},"axis_line_dash":[2,2],"formatter":{"id":"1029","type":"BasicTickFormatter"},"major_label_text_color":{"value":"rgb(88, 88, 88)"},"major_tick_in":0,"major_tick_line_color":{"value":"white"},"major_tick_out":0,"minor_tick_line_color":{"value":"white"},"minor_tick_out":0,"ticker":{"id":"1022","type":"BasicTicker"}},"id":"1021","type":"LinearAxis"},{"attributes":{},"id":"1022","type":"BasicTicker"},{"attributes":{"dimension":1,"grid_line_color":"rgb(150, 150, 150)","grid_line_dash":[2,2],"ticker":{"id":"1022","type":"BasicTicker"}},"id":"1025","type":"Grid"},{"attributes":{"source":{"id":"1001","type":"ColumnDataSource"}},"id":"1039","type":"CDSView"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":null,"active_tap":"auto","logo":null},"id":"1026","type":"Toolbar"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"line_width":{"value":3},"x":{"field":"x"},"y":{"field":"y"}},"id":"1042","type":"Circle"},{"attributes":{},"id":"1066","type":"UnionRenderers"},{"attributes":{},"id":"1067","type":"Selection"},{"attributes":{},"id":"1029","type":"BasicTickFormatter"},{"attributes":{},"id":"1068","type":"UnionRenderers"},{"attributes":{},"id":"1069","type":"Selection"}],"root_ids":["1060"]},"title":"Bokeh Application","version":"1.4.0"}};
  var render_items = [{"docid":"907d6c98-1b43-459a-a224-51b7858c66b5","roots":{"1060":"e4e80e78-ff03-4892-8059-a6efbd13af23"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
          </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p class="steps">
        5 - For classifying a new "test" example (with unknown class) it will only be necessary to give an input to the classifier, i.e., a list with the features values of the "test" example
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">
       In [8]:
      </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="c1"># A list with 8 arbitrary entries.</span>
<span class="n">test_examples_features</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">]</span>

<span class="c1"># Classification.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Returned Class: "</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knn_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test_examples_features</span><span class="p">]))</span>

<span class="c1"># Probability of Accuracy.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Probability of each class:"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knn_classifier</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([</span><span class="n">test_examples_features</span><span class="p">]))</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Returned Class: 
[1]
Probability of each class:
[[0.4 0.6 0.  0. ]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        There is a clear doubt between class "0" ("No Action") and class "1" ("Paper"), with 40 % and 60 % of accuracy probability, respectively.
       </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
        With the steps described on the current volume of "Classification Game", our classifier is trained and ready to receive new examples and classify them immediately.
       </p>
<p>
        There is only one remaining task, that will be briefly explained on the
        <a href="../Evaluate/classification_game_volume_5_rev.php">
         final volume
         <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
        , consisting in the objective evaluation of the classifier quality.
       </p>
<p>
<strong>
<span class="color7">
          We hope that you have enjoyed this guide.
         </span>
<span class="color2">
          biosignalsnotebooks
         </span>
<span class="color4">
          is an environment in continuous expansion, so don"t stop your journey and learn more with the remaining
          <a href="../MainFiles/biosignalsnotebooks_rev.php">
           Notebooks
           <img height="10px" src="../../images/icons/link.png" style="display:inline" width="10px"/>
</a>
</span>
</strong>
        !
       </p>
</div>
</div>
</div>
<div class="hide_mark hide">
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
<span class="color6">
          **Auxiliary Code Segment (should not be replicated by
the user)**
         </span>
</p>
</div>
</div>
</div>
</div>
<div class="hide_both">
<div class="cell border-box-sizing code_cell rendered">
<div class="input hide">
<div class="prompt input_prompt">
        In [9]:
       </div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3">
<pre><span></span><span class="kn">from</span> <span class="nn">biosignalsnotebooks.__notebook_support__</span> <span class="k">import</span> <span class="n">css_style_apply</span>
<span class="n">css_style_apply</span><span class="p">()</span>
</pre>
</div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output hide">
<div class="output_area">
<div class="prompt">
</div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.................... CSS Style Applied to Jupyter Notebook .........................
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">
          Out[9]:
         </div>
<div class="output_html rendered_html output_subarea output_execute_result">

<div id="style_import">

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>